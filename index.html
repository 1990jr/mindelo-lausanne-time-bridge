<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mindelo â†” Lausanne Time Bridge</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸŒ‰</text></svg>">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* ===== CSS Reset & Variables ===== */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Cabo Verde palette */
            --cv-ocean: #0077b6;
            --cv-deep: #023e8a;
            --cv-sky: #48cae4;
            --cv-sand: #f4a261;
            --cv-warm: #e76f51;
            --cv-light: #caf0f8;
            --cv-gradient: linear-gradient(135deg, #023e8a 0%, #0077b6 40%, #48cae4 70%, #f4a261 100%);

            /* Swiss palette */
            --ch-red: #d62828;
            --ch-mountain: #2d6a4f;
            --ch-snow: #f8f9fa;
            --ch-slate: #495057;
            --ch-lake: #457b9d;
            --ch-cream: #fefae0;
            --ch-gradient: linear-gradient(135deg, #495057 0%, #457b9d 30%, #2d6a4f 60%, #f8f9fa 100%);

            /* Shared */
            --bridge-gold: #d4a373;
            --text-dark: #1a1a2e;
            --text-light: #f8f9fa;
            --font-body: 'Inter', -apple-system, sans-serif;
            --font-display: 'Playfair Display', Georgia, serif;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: var(--font-body);
            color: var(--text-dark);
            background: #f0f0f5;
            overflow-x: hidden;
        }

        /* ===== Header / Bridge ===== */
        .bridge-header {
            background: linear-gradient(135deg, var(--cv-deep) 0%, var(--bridge-gold) 50%, var(--ch-mountain) 100%);
            padding: 1.5rem 1rem 1rem;
            text-align: center;
            color: white;
            position: relative;
            overflow: hidden;
        }

        .bridge-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            opacity: 0.5;
        }

        .bridge-header h1 {
            font-family: var(--font-display);
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            font-weight: 700;
            position: relative;
            z-index: 1;
        }

        .bridge-header h1 .bridge-icon {
            display: inline-block;
            margin: 0 0.3em;
            animation: pulse 2s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .bridge-header .subtitle {
            font-size: 0.95rem;
            opacity: 0.85;
            margin-top: 0.3rem;
            position: relative;
            z-index: 1;
            font-weight: 300;
        }

        /* ===== Language Switcher ===== */
        .lang-switcher {
            display: flex;
            justify-content: center;
            gap: 0.4rem;
            margin-top: 0.75rem;
            position: relative;
            z-index: 1;
        }

        .lang-btn {
            background: rgba(255,255,255,0.15);
            border: 1.5px solid rgba(255,255,255,0.3);
            color: rgba(255,255,255,0.8);
            padding: 0.25rem 0.7rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: var(--font-body);
            letter-spacing: 0.5px;
        }

        .lang-btn:hover {
            background: rgba(255,255,255,0.25);
            color: white;
        }

        .lang-btn.active {
            background: white;
            color: var(--text-dark);
            border-color: white;
        }

        /* ===== Time Difference Banner ===== */
        .time-diff-banner {
            background: var(--text-dark);
            color: var(--text-light);
            text-align: center;
            padding: 0.5rem;
            font-size: 0.85rem;
            font-weight: 500;
            letter-spacing: 0.5px;
        }

        .time-diff-banner span {
            color: var(--bridge-gold);
        }

        /* ===== Dual Clock Section ===== */
        .clocks-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            min-height: 320px;
        }

        .clock-panel {
            padding: 2rem 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .clock-panel::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            opacity: 0.08;
            z-index: 0;
        }

        .clock-panel > * {
            position: relative;
            z-index: 1;
        }

        /* Cabo Verde panel */
        .clock-cv {
            background: linear-gradient(180deg, #023e8a 0%, #0077b6 60%, #48cae4 100%);
            color: white;
        }

        .clock-cv::before {
            background:
                radial-gradient(ellipse at 50% 120%, rgba(244, 162, 97, 0.3) 0%, transparent 60%),
                url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 200'%3E%3Cpath d='M0,160 Q50,140 100,155 T200,150 T300,145 T400,160 L400,200 L0,200 Z' fill='%23f4a261' opacity='0.15'/%3E%3Cpath d='M0,170 Q60,155 120,165 T240,160 T360,158 T400,170 L400,200 L0,200 Z' fill='%2348cae4' opacity='0.1'/%3E%3C/svg%3E");
            background-size: cover;
            background-position: bottom;
        }

        /* Swiss panel */
        .clock-ch {
            background: linear-gradient(180deg, #457b9d 0%, #a8dadc 40%, #f1faee 100%);
            color: var(--text-dark);
        }

        .clock-ch::before {
            background:
                url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 200'%3E%3Cpath d='M0,120 L40,80 L80,110 L130,50 L180,90 L220,40 L270,85 L320,55 L360,95 L400,70 L400,200 L0,200 Z' fill='%232d6a4f' opacity='0.08'/%3E%3Cpath d='M0,150 L50,120 L100,140 L160,100 L210,130 L260,95 L310,125 L370,105 L400,120 L400,200 L0,200 Z' fill='%23495057' opacity='0.05'/%3E%3C/svg%3E");
            background-size: cover;
            background-position: bottom;
        }

        .clock-location {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            font-weight: 600;
            opacity: 0.8;
            margin-bottom: 0.25rem;
        }

        .clock-city {
            font-family: var(--font-display);
            font-size: clamp(1.8rem, 4vw, 2.8rem);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .clock-flag {
            font-size: 1.5rem;
            margin-bottom: 0.75rem;
        }

        .clock-time {
            font-size: clamp(2.5rem, 6vw, 4rem);
            font-weight: 700;
            font-variant-numeric: tabular-nums;
            letter-spacing: 2px;
            line-height: 1;
        }

        .clock-seconds {
            font-size: 0.5em;
            opacity: 0.7;
            font-weight: 400;
        }

        .clock-date {
            font-size: 0.9rem;
            margin-top: 0.5rem;
            opacity: 0.8;
            font-weight: 400;
        }

        .clock-timezone {
            font-size: 0.75rem;
            opacity: 0.6;
            margin-top: 0.25rem;
            font-weight: 500;
        }

        /* ===== "What's Happening Now" Section ===== */
        .happening-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
        }

        .happening-panel {
            padding: 1.5rem;
            text-align: center;
        }

        .happening-cv {
            background: linear-gradient(135deg, #caf0f8, #e8f8ff);
            border-bottom: 3px solid var(--cv-ocean);
        }

        .happening-ch {
            background: linear-gradient(135deg, #f1faee, #fefae0);
            border-bottom: 3px solid var(--ch-mountain);
        }

        .happening-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            font-weight: 600;
            color: #666;
            margin-bottom: 0.5rem;
        }

        .happening-emoji {
            font-size: 2rem;
            margin-bottom: 0.5rem;
            display: block;
        }

        .happening-text {
            font-size: 0.95rem;
            line-height: 1.5;
            font-weight: 500;
            color: var(--text-dark);
        }

        /* ===== Best Time To Call ===== */
        .call-section {
            background: #ffffff;
            padding: 0 1.5rem 1.75rem;
        }

        .call-card {
            max-width: 900px;
            margin: 0 auto;
            border: 1px solid #e4e6ea;
            border-radius: 14px;
            background: linear-gradient(145deg, #ffffff, #f7f9fb);
            padding: 1rem;
            box-shadow: 0 6px 18px rgba(0, 0, 0, 0.06);
        }

        .call-status {
            font-size: 1rem;
            font-weight: 700;
            margin-bottom: 0.35rem;
            color: var(--text-dark);
        }

        .call-next {
            font-size: 0.9rem;
            color: #4f5b67;
            margin-bottom: 0.9rem;
        }

        .work-hours-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }

        .hours-panel {
            border-radius: 10px;
            padding: 0.75rem;
            background: #f8fafc;
        }

        .hours-cv {
            border-left: 3px solid var(--cv-ocean);
        }

        .hours-ch {
            border-left: 3px solid var(--ch-red);
        }

        .hours-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            color: #6a7178;
            margin-bottom: 0.25rem;
            font-weight: 600;
        }

        .hours-value {
            font-size: 0.9rem;
            font-weight: 600;
            color: #1f2933;
        }

        /* ===== Weather Section ===== */
        .weather-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1px;
            background: #e0e0e0;
        }

        .weather-panel {
            padding: 1.5rem;
            background: white;
            text-align: center;
        }

        .weather-panel h3 {
            font-family: var(--font-display);
            font-size: 1.1rem;
            margin-bottom: 1rem;
        }

        .weather-cv h3 { color: var(--cv-ocean); }
        .weather-ch h3 { color: var(--ch-mountain); }

        .weather-icon {
            font-size: 3rem;
            margin-bottom: 0.5rem;
        }

        .weather-temp {
            font-size: 2rem;
            font-weight: 700;
        }

        .weather-desc {
            font-size: 0.85rem;
            color: #666;
            text-transform: capitalize;
            margin-top: 0.25rem;
        }

        .weather-details {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 0.75rem;
            font-size: 0.8rem;
            color: #888;
        }

        .weather-details span {
            display: flex;
            align-items: center;
            gap: 0.25rem;
        }

        .weather-error {
            font-size: 0.85rem;
            color: #999;
            padding: 1rem;
        }

        /* ===== Section Dividers ===== */
        .section-title {
            text-align: center;
            padding: 1.5rem 1rem 0.75rem;
            background: #f0f0f5;
        }

        .section-title h2 {
            font-family: var(--font-display);
            font-size: 1.5rem;
            color: var(--text-dark);
        }

        .section-title p {
            font-size: 0.85rem;
            color: #888;
            margin-top: 0.25rem;
        }

        /* ===== Cultural Calendar ===== */
        .calendar-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            padding: 0 1rem 1rem;
            background: #f0f0f5;
        }

        .calendar-panel {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            overflow: hidden;
        }

        .calendar-header {
            padding: 1rem 1.25rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid #f0f0f0;
        }

        .calendar-header h3 {
            font-family: var(--font-display);
            font-size: 1.05rem;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .calendar-cv .calendar-header h3 { color: var(--cv-ocean); }
        .calendar-ch .calendar-header h3 { color: var(--ch-mountain); }

        .event-count {
            font-family: var(--font-body);
            font-size: 0.65rem;
            font-weight: 600;
            background: #eee;
            color: #888;
            padding: 0.2rem 0.5rem;
            border-radius: 10px;
            letter-spacing: 0.3px;
        }

        /* Next up highlight */
        .calendar-next {
            padding: 0.9rem 1.25rem;
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .calendar-cv .calendar-next {
            background: linear-gradient(135deg, #e8f4fd, #caf0f8);
            border-bottom: 2px solid var(--cv-ocean);
        }

        .calendar-ch .calendar-next {
            background: linear-gradient(135deg, #edf6f0, #dceee4);
            border-bottom: 2px solid var(--ch-mountain);
        }

        .next-label {
            font-size: 0.6rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 700;
            opacity: 0.6;
            margin-bottom: 0.15rem;
        }

        .calendar-next .event-date {
            background: white;
            border-radius: 8px;
            padding: 0.35rem 0.55rem;
            font-size: 0.7rem;
            font-weight: 700;
            white-space: nowrap;
            min-width: 52px;
            text-align: center;
            color: #333;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .calendar-cv .calendar-next .event-date { border-left: 3px solid var(--cv-ocean); }
        .calendar-ch .calendar-next .event-date { border-left: 3px solid var(--ch-mountain); }

        .calendar-next .event-name {
            font-weight: 700;
            font-size: 0.9rem;
        }

        .calendar-next .event-desc {
            font-size: 0.75rem;
            color: #666;
            margin-top: 0.1rem;
        }

        /* Scrollable list */
        .calendar-list-wrapper {
            position: relative;
        }

        .calendar-list {
            max-height: 280px;
            overflow-y: auto;
            padding: 0.25rem 1.25rem 0.75rem;
            scrollbar-width: thin;
            scrollbar-color: #ccc transparent;
        }

        .calendar-list::-webkit-scrollbar {
            width: 4px;
        }

        .calendar-list::-webkit-scrollbar-track {
            background: transparent;
        }

        .calendar-list::-webkit-scrollbar-thumb {
            background: #ddd;
            border-radius: 4px;
        }

        .calendar-fade {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: linear-gradient(transparent, white);
            pointer-events: none;
            border-radius: 0 0 12px 12px;
            transition: opacity 0.2s;
        }

        .calendar-fade.hidden {
            opacity: 0;
        }

        .event-item {
            padding: 0.5rem 0;
            border-bottom: 1px solid #f5f5f5;
            display: flex;
            gap: 0.65rem;
            align-items: flex-start;
        }

        .event-item:last-child {
            border-bottom: none;
        }

        .event-date {
            background: #f8f8f8;
            border-radius: 6px;
            padding: 0.25rem 0.45rem;
            font-size: 0.65rem;
            font-weight: 600;
            white-space: nowrap;
            min-width: 48px;
            text-align: center;
            color: #555;
        }

        .calendar-cv .event-date { border-left: 3px solid var(--cv-ocean); }
        .calendar-ch .event-date { border-left: 3px solid var(--ch-red); }

        .event-info {
            flex: 1;
        }

        .event-name {
            font-weight: 600;
            font-size: 0.8rem;
        }

        .event-desc {
            font-size: 0.7rem;
            color: #999;
            margin-top: 0.1rem;
        }

        .event-past {
            opacity: 0.4;
        }

        /* ===== News & Media ===== */
        .media-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            padding: 0 1rem 1rem;
            background: #f0f0f5;
        }

        .media-panel {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            padding: 1.25rem;
        }

        .media-panel h3 {
            font-family: var(--font-display);
            font-size: 1rem;
            margin-bottom: 0.85rem;
            display: flex;
            align-items: center;
            gap: 0.4rem;
        }

        .media-cv h3 { color: var(--cv-ocean); }
        .media-ch h3 { color: var(--ch-mountain); }

        .media-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.5rem;
        }

        .media-link {
            display: flex;
            align-items: center;
            gap: 0.55rem;
            padding: 0.55rem 0.7rem;
            border-radius: 8px;
            text-decoration: none;
            color: var(--text-dark);
            background: #f8f9fa;
            border: 1px solid #eee;
            transition: all 0.15s ease;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .media-link:hover {
            background: #eef2ff;
            border-color: #c5cae9;
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(0,0,0,0.06);
        }

        .media-link .media-icon {
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .media-link .media-info {
            display: flex;
            flex-direction: column;
            min-width: 0;
        }

        .media-link .media-name {
            font-weight: 600;
            font-size: 0.78rem;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .media-link .media-type {
            font-size: 0.6rem;
            color: #999;
            font-weight: 400;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* ===== Neuroscience Tip ===== */
        .neuro-section {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            color: white;
            padding: 2rem 1.5rem;
            text-align: center;
        }

        .neuro-section h2 {
            font-family: var(--font-display);
            font-size: 1.3rem;
            margin-bottom: 0.25rem;
        }

        .neuro-category {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--bridge-gold);
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .neuro-tip {
            max-width: 600px;
            margin: 0 auto;
            font-size: 1rem;
            line-height: 1.7;
            font-weight: 300;
        }

        .neuro-emoji {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
            display: block;
        }

        .neuro-source {
            font-size: 0.7rem;
            opacity: 0.5;
            margin-top: 1rem;
        }

        /* ===== Footer ===== */
        .bridge-footer {
            background: var(--text-dark);
            color: rgba(255,255,255,0.5);
            text-align: center;
            padding: 1.25rem;
            font-size: 0.75rem;
        }

        .bridge-footer .hearts {
            color: var(--bridge-gold);
            margin: 0 0.25rem;
        }

        /* ===== Mobile Responsive ===== */
        @media (max-width: 700px) {
            .clocks-section,
            .happening-section,
            .work-hours-grid,
            .weather-section,
            .calendar-section,
            .media-section {
                grid-template-columns: 1fr;
            }

            .media-grid {
                grid-template-columns: 1fr 1fr;
            }

            .clock-panel {
                padding: 1.5rem 1rem;
                min-height: auto;
            }

            .clock-time {
                font-size: 3rem;
            }

            .happening-panel {
                padding: 1rem;
            }
        }

        /* ===== Animations ===== */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeInUp 0.5s ease-out;
        }

        /* Smooth time transition */
        .clock-time {
            transition: opacity 0.15s ease;
        }
    </style>
</head>
<body>

    <!-- Header -->
    <header class="bridge-header">
        <h1>Mindelo <span class="bridge-icon">ğŸŒ‰</span> Lausanne</h1>
        <p class="subtitle" id="subtitle">A bridge between two homes</p>
        <div class="lang-switcher">
            <button class="lang-btn active" onclick="setLanguage('en')">EN</button>
            <button class="lang-btn" onclick="setLanguage('fr')">FR</button>
            <button class="lang-btn" onclick="setLanguage('pt')">PT</button>
        </div>
    </header>

    <!-- Time Difference -->
    <div class="time-diff-banner" id="timeDiffBanner">
        <span id="timeDiffPrefix">Lausanne is</span> <span id="timeDiff">2 hours</span> <span id="timeDiffSuffix">ahead of Mindelo</span>
    </div>

    <!-- Dual Clocks -->
    <section class="clocks-section">
        <div class="clock-panel clock-cv">
            <div class="clock-location" id="locationCv">Cabo Verde</div>
            <div class="clock-city">Mindelo</div>
            <div class="clock-flag">ğŸ‡¨ğŸ‡»</div>
            <div class="clock-time" id="timeMindelo">--:--</div>
            <div class="clock-date" id="dateMindelo">Loading...</div>
            <div class="clock-timezone" id="tzMindelo">CVT (UTC-1)</div>
        </div>
        <div class="clock-panel clock-ch">
            <div class="clock-location" id="locationCh">Switzerland</div>
            <div class="clock-city">Lausanne</div>
            <div class="clock-flag">ğŸ‡¨ğŸ‡­</div>
            <div class="clock-time" id="timeLausanne">--:--</div>
            <div class="clock-date" id="dateLausanne">Loading...</div>
            <div class="clock-timezone" id="tzLausanne">CET (UTC+1)</div>
        </div>
    </section>

    <!-- What's Happening Now -->
    <section class="happening-section">
        <div class="happening-panel happening-cv">
            <div class="happening-label" id="happeningLabelCv">Right now in Mindelo</div>
            <span class="happening-emoji" id="happeningCvEmoji">â˜€ï¸</span>
            <div class="happening-text" id="happeningCv">Loading...</div>
        </div>
        <div class="happening-panel happening-ch">
            <div class="happening-label" id="happeningLabelCh">Right now in Lausanne</div>
            <span class="happening-emoji" id="happeningChEmoji">ğŸ”ï¸</span>
            <div class="happening-text" id="happeningCh">Loading...</div>
        </div>
    </section>

    <!-- Best Time to Call -->
    <div class="section-title">
        <h2 id="callTitle">Best Time to Call</h2>
        <p id="callSubtitle">Weekend overlap when both cities are awake</p>
    </div>

    <section class="call-section">
        <div class="call-card">
            <div class="call-status" id="callStatus">Checking overlap...</div>
            <div class="call-next" id="callNext">Loading...</div>
            <div class="work-hours-grid">
                <div class="hours-panel hours-cv">
                    <div class="hours-label" id="callHoursCvLabel">ğŸ‡¨ğŸ‡» Mindelo call window</div>
                    <div class="hours-value" id="workHoursCv">Sat-Sun, 08:00-21:00</div>
                </div>
                <div class="hours-panel hours-ch">
                    <div class="hours-label" id="callHoursChLabel">ğŸ‡¨ğŸ‡­ Lausanne call window</div>
                    <div class="hours-value" id="workHoursCh">Sat-Sun, 08:00-21:00</div>
                </div>
            </div>
        </div>
    </section>

    <!-- Weather -->
    <div class="section-title">
        <h2 id="weatherTitle">Weather Comparison</h2>
        <p id="weatherSubtitle">Live conditions in both cities</p>
    </div>

    <section class="weather-section">
        <div class="weather-panel weather-cv" id="weatherCv">
            <h3 id="weatherCvTitle">ğŸ‡¨ğŸ‡» Mindelo Weather</h3>
            <div id="weatherCvContent">
                <div class="weather-error" id="weatherCvLoading">Loading weather data...</div>
            </div>
        </div>
        <div class="weather-panel weather-ch" id="weatherCh">
            <h3 id="weatherChTitle">ğŸ‡¨ğŸ‡­ Lausanne Weather</h3>
            <div id="weatherChContent">
                <div class="weather-error" id="weatherChLoading">Loading weather data...</div>
            </div>
        </div>
    </section>

    <!-- Cultural Calendar -->
    <div class="section-title">
        <h2 id="calendarTitle">Cultural Calendar</h2>
        <p id="calendarSubtitle">Upcoming holidays &amp; events</p>
    </div>

    <section class="calendar-section">
        <div class="calendar-panel calendar-cv" id="calendarCv"></div>
        <div class="calendar-panel calendar-ch" id="calendarCh"></div>
    </section>

    <!-- News & Media -->
    <div class="section-title">
        <h2 id="mediaTitle">News &amp; Media</h2>
        <p id="mediaSubtitle">Stay connected with what's happening back home</p>
    </div>

    <section class="media-section">
        <div class="media-panel media-cv">
            <h3 id="mediaCvTitle">ğŸ‡¨ğŸ‡» Cabo Verde & Mindelo</h3>
            <div class="media-grid" id="mediaGridCv">
                <a href="https://mindelinsite.com/" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸ“°</span>
                    <span class="media-info">
                        <span class="media-name">Mindel Insite</span>
                        <span class="media-type" data-i18n="mediaTypeSvNews">SÃ£o Vicente news</span>
                    </span>
                </a>
                <a href="https://www.balai.cv/" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸŒ</span>
                    <span class="media-info">
                        <span class="media-name">Balai</span>
                        <span class="media-type" data-i18n="mediaTypeAggregator">Aggregator</span>
                    </span>
                </a>
                <a href="https://asemana.sapo.cv/" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸ“°</span>
                    <span class="media-info">
                        <span class="media-name">A Semana</span>
                        <span class="media-type" data-i18n="mediaTypeWeekly">Weekly newspaper</span>
                    </span>
                </a>
                <a href="https://expressodasilhas.cv/" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸ“°</span>
                    <span class="media-info">
                        <span class="media-name">Expresso das Ilhas</span>
                        <span class="media-type" data-i18n="mediaTypeDaily">Daily newspaper</span>
                    </span>
                </a>
                <a href="https://inforpress.cv/" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸ›ï¸</span>
                    <span class="media-info">
                        <span class="media-name">Inforpress</span>
                        <span class="media-type" data-i18n="mediaTypeAgency">News agency</span>
                    </span>
                </a>
                <a href="https://anacao.cv/" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸ“°</span>
                    <span class="media-info">
                        <span class="media-name">A NaÃ§Ã£o</span>
                        <span class="media-type" data-i18n="mediaTypeNewspaper">Newspaper</span>
                    </span>
                </a>
                <a href="https://santiagomagazine.cv/" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸ“–</span>
                    <span class="media-info">
                        <span class="media-name">Santiago Magazine</span>
                        <span class="media-type" data-i18n="mediaTypeMagazine">Magazine</span>
                    </span>
                </a>
                <a href="https://rtc.cv/" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸ“º</span>
                    <span class="media-info">
                        <span class="media-name">RTC (TCV)</span>
                        <span class="media-type" data-i18n="mediaTypeTvRadio">TV & Radio</span>
                    </span>
                </a>
            </div>
        </div>
        <div class="media-panel media-ch">
            <h3 id="mediaChTitle">ğŸ‡¨ğŸ‡­ Lausanne & Vaud</h3>
            <div class="media-grid" id="mediaGridCh">
                <a href="https://www.rts.ch/info/regions/vaud/" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸ“º</span>
                    <span class="media-info">
                        <span class="media-name">RTS Info</span>
                        <span class="media-type" data-i18n="mediaTypePublic">Public broadcaster</span>
                    </span>
                </a>
                <a href="https://www.20min.ch/fr/suisse-romande/vaud" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸ“°</span>
                    <span class="media-info">
                        <span class="media-name">20 Minutes</span>
                        <span class="media-type" data-i18n="mediaTypeFreeDaily">Free daily</span>
                    </span>
                </a>
                <a href="https://www.24heures.ch/" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸ“°</span>
                    <span class="media-info">
                        <span class="media-name">24 Heures</span>
                        <span class="media-type" data-i18n="mediaTypeVaudDaily">Vaud daily</span>
                    </span>
                </a>
                <a href="https://www.letemps.ch/" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸ“°</span>
                    <span class="media-info">
                        <span class="media-name">Le Temps</span>
                        <span class="media-type" data-i18n="mediaTypeRomande">Suisse romande</span>
                    </span>
                </a>
                <a href="https://www.lematin.ch/" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸ“°</span>
                    <span class="media-info">
                        <span class="media-name">Le Matin</span>
                        <span class="media-type" data-i18n="mediaTypeTabloid">Tabloid</span>
                    </span>
                </a>
                <a href="https://lausannecites.ch/" target="_blank" rel="noopener" class="media-link">
                    <span class="media-icon">ğŸ˜ï¸</span>
                    <span class="media-info">
                        <span class="media-name">Lausanne CitÃ©s</span>
                        <span class="media-type" data-i18n="mediaTypeLocalWeekly">Local weekly</span>
                    </span>
                </a>
            </div>
        </div>
    </section>

    <!-- Neuroscience Tip -->
    <section class="neuro-section" id="neuroSection">
        <h2 id="neuroTitle">ğŸ§  Daily Brain Insight</h2>
        <div class="neuro-category" id="neuroCategory">Loading...</div>
        <span class="neuro-emoji" id="neuroEmoji">ğŸ§¬</span>
        <div class="neuro-tip" id="neuroTip">Loading your daily tip...</div>
        <div class="neuro-source" id="neuroSource"></div>
    </section>

    <!-- Footer -->
    <footer class="bridge-footer" id="footer">
        Mindelo â†” Lausanne Time Bridge <span class="hearts">â™¥</span> <span id="footerText">Connecting two homes across the Atlantic</span>
    </footer>

    <script>
    // ===================================================================
    //  MINDELO-LAUSANNE TIME BRIDGE - Main Application Script
    //  with i18n support for EN, FR, PT
    // ===================================================================

    (function() {
        'use strict';

        // ---- Configuration ----
        const MINDELO_TZ = 'Atlantic/Cape_Verde';  // UTC-1 year-round
        const LAUSANNE_TZ = 'Europe/Zurich';        // CET/CEST

        // ---- i18n Translations ----
        let currentLang = localStorage.getItem('timeBridgeLang') || 'en';

        const LOCALES = { en: 'en-GB', fr: 'fr-FR', pt: 'pt-PT' };

        const T = {
            // ---- Header & structure ----
            subtitle:           { en: 'A bridge between two homes', fr: 'Un pont entre deux maisons', pt: 'Uma ponte entre duas casas' },
            timeDiffPrefix:     { en: 'Lausanne is', fr: 'Lausanne a', pt: 'Lausanne estÃ¡' },
            timeDiffSuffix:     { en: 'ahead of Mindelo', fr: "d'avance sur Mindelo", pt: 'Ã  frente de Mindelo' },
            hour:               { en: 'hour', fr: 'heure', pt: 'hora' },
            hours:              { en: 'hours', fr: 'heures', pt: 'horas' },
            locationCv:         { en: 'Cabo Verde', fr: 'Cabo Verde', pt: 'Cabo Verde' },
            locationCh:         { en: 'Switzerland', fr: 'Suisse', pt: 'SuÃ­Ã§a' },

            // ---- Happening labels ----
            happeningLabelCv:   { en: 'Right now in Mindelo', fr: 'En ce moment Ã  Mindelo', pt: 'Neste momento em Mindelo' },
            happeningLabelCh:   { en: 'Right now in Lausanne', fr: 'En ce moment Ã  Lausanne', pt: 'Neste momento em Lausanne' },

            // ---- Best time to call ----
            callTitle:          { en: 'Best Time to Call', fr: 'Meilleur moment pour appeler', pt: 'Melhor horÃ¡rio para ligar' },
            callSubtitle:       { en: 'Weekend overlap when both cities are awake', fr: "Chevauchement du week-end quand les deux villes sont rÃ©veillÃ©es", pt: 'SobreposiÃ§Ã£o no fim de semana quando as duas cidades estÃ£o acordadas' },
            callHoursCvLabel:   { en: 'ğŸ‡¨ğŸ‡» Mindelo call window', fr: "ğŸ‡¨ğŸ‡» FenÃªtre d'appel Ã  Mindelo", pt: 'ğŸ‡¨ğŸ‡» Janela para ligar em Mindelo' },
            callHoursChLabel:   { en: 'ğŸ‡¨ğŸ‡­ Lausanne call window', fr: "ğŸ‡¨ğŸ‡­ FenÃªtre d'appel Ã  Lausanne", pt: 'ğŸ‡¨ğŸ‡­ Janela para ligar em Lausanne' },
            callHoursCvValue:   { en: 'Sat-Sun, 08:00-21:00', fr: 'Sam-Dim, 08:00-21:00', pt: 'SÃ¡b-Dom, 08:00-21:00' },
            callHoursChValue:   { en: 'Sat-Sun, 08:00-21:00', fr: 'Sam-Dim, 08:00-21:00', pt: 'SÃ¡b-Dom, 08:00-21:00' },
            callStatusNow:      { en: 'Good moment to call now', fr: 'Bon moment pour appeler maintenant', pt: 'Bom momento para ligar agora' },
            callStatusLater:    { en: 'Next overlap window', fr: 'Prochaine fenÃªtre commune', pt: 'PrÃ³xima janela em comum' },
            callStatusNone:     { en: 'No overlap in the next 7 days', fr: 'Aucun chevauchement dans les 7 prochains jours', pt: 'Sem sobreposiÃ§Ã£o nos prÃ³ximos 7 dias' },
            callUntil:          { en: 'Until', fr: "Jusqu'Ã ", pt: 'AtÃ©' },
            callNoWindow:       { en: 'Check next weekend', fr: 'VÃ©rifiez le week-end prochain', pt: 'Verifique no prÃ³ximo fim de semana' },
            callWindowPrefix:   { en: 'Lausanne', fr: 'Lausanne', pt: 'Lausanne' },
            callWindowSuffix:   { en: 'Mindelo', fr: 'Mindelo', pt: 'Mindelo' },

            // ---- Weather ----
            weatherTitle:       { en: 'Weather Comparison', fr: 'Comparaison mÃ©tÃ©o', pt: 'ComparaÃ§Ã£o meteorolÃ³gica' },
            weatherSubtitle:    { en: 'Live conditions in both cities', fr: 'Conditions en direct dans les deux villes', pt: 'CondiÃ§Ãµes em tempo real nas duas cidades' },
            weatherCvTitle:     { en: 'ğŸ‡¨ğŸ‡» Mindelo Weather', fr: 'ğŸ‡¨ğŸ‡» MÃ©tÃ©o Mindelo', pt: 'ğŸ‡¨ğŸ‡» Tempo em Mindelo' },
            weatherChTitle:     { en: 'ğŸ‡¨ğŸ‡­ Lausanne Weather', fr: 'ğŸ‡¨ğŸ‡­ MÃ©tÃ©o Lausanne', pt: 'ğŸ‡¨ğŸ‡­ Tempo em Lausanne' },
            weatherLoading:     { en: 'Loading weather data...', fr: 'Chargement des donnÃ©es mÃ©tÃ©o...', pt: 'A carregar dados meteorolÃ³gicos...' },
            weatherUnavailable: { en: 'Weather unavailable', fr: 'MÃ©tÃ©o indisponible', pt: 'Tempo indisponÃ­vel' },
            weatherFetchError:  { en: 'Could not fetch weather data', fr: 'Impossible de rÃ©cupÃ©rer la mÃ©tÃ©o', pt: 'NÃ£o foi possÃ­vel obter dados meteorolÃ³gicos' },
            feelsLike:          { en: 'Feels', fr: 'Ressenti', pt: 'SensaÃ§Ã£o' },

            // ---- Calendar ----
            calendarTitle:      { en: 'Cultural Calendar', fr: 'Calendrier culturel', pt: 'CalendÃ¡rio cultural' },
            calendarSubtitle:   { en: 'Upcoming holidays & events', fr: 'FÃªtes & Ã©vÃ©nements Ã  venir', pt: 'Feriados e eventos futuros' },
            calendarCvTitle:    { en: 'Cabo Verde & Mindelo', fr: 'Cabo Verde & Mindelo', pt: 'Cabo Verde & Mindelo' },
            calendarChTitle:    { en: 'Lausanne & Vaud', fr: 'Lausanne & Vaud', pt: 'Lausanne & Vaud' },
            nextUp:             { en: 'Next up', fr: 'Prochain', pt: 'PrÃ³ximo' },
            events:             { en: 'events', fr: 'Ã©vÃ©nements', pt: 'eventos' },

            // ---- Media ----
            mediaTitle:         { en: 'News & Media', fr: 'ActualitÃ©s & MÃ©dias', pt: 'NotÃ­cias e Media' },
            mediaSubtitle:      { en: "Stay connected with what's happening back home", fr: 'Restez connectÃ© Ã  ce qui se passe chez vous', pt: 'Mantenha-se ligado ao que acontece em casa' },
            mediaCvTitle:       { en: 'ğŸ‡¨ğŸ‡» Cabo Verde & Mindelo', fr: 'ğŸ‡¨ğŸ‡» Cabo Verde & Mindelo', pt: 'ğŸ‡¨ğŸ‡» Cabo Verde & Mindelo' },
            mediaChTitle:       { en: 'ğŸ‡¨ğŸ‡­ Lausanne & Vaud', fr: 'ğŸ‡¨ğŸ‡­ Lausanne & Vaud', pt: 'ğŸ‡¨ğŸ‡­ Lausanne & Vaud' },
            // Media type labels
            mediaTypeSvNews:    { en: 'SÃ£o Vicente news', fr: 'ActualitÃ©s SÃ£o Vicente', pt: 'NotÃ­cias SÃ£o Vicente' },
            mediaTypeAggregator:{ en: 'Aggregator', fr: 'AgrÃ©gateur', pt: 'Agregador' },
            mediaTypeWeekly:    { en: 'Weekly newspaper', fr: 'Hebdomadaire', pt: 'SemanÃ¡rio' },
            mediaTypeDaily:     { en: 'Daily newspaper', fr: 'Quotidien', pt: 'DiÃ¡rio' },
            mediaTypeAgency:    { en: 'News agency', fr: "Agence de presse", pt: 'AgÃªncia de notÃ­cias' },
            mediaTypeNewspaper: { en: 'Newspaper', fr: 'Journal', pt: 'Jornal' },
            mediaTypeMagazine:  { en: 'Magazine', fr: 'Magazine', pt: 'Revista' },
            mediaTypeTvRadio:   { en: 'TV & Radio', fr: 'TV & Radio', pt: 'TV & RÃ¡dio' },
            mediaTypePublic:    { en: 'Public broadcaster', fr: 'Service public', pt: 'ServiÃ§o pÃºblico' },
            mediaTypeFreeDaily: { en: 'Free daily', fr: 'Gratuit quotidien', pt: 'DiÃ¡rio gratuito' },
            mediaTypeVaudDaily: { en: 'Vaud daily', fr: 'Quotidien vaudois', pt: 'DiÃ¡rio de Vaud' },
            mediaTypeRomande:   { en: 'Suisse romande', fr: 'Suisse romande', pt: 'SuÃ­Ã§a romanda' },
            mediaTypeTabloid:   { en: 'Tabloid', fr: 'TabloÃ¯d', pt: 'TablÃ³ide' },
            mediaTypeLocalWeekly:{ en: 'Local weekly', fr: 'Hebdomadaire local', pt: 'SemanÃ¡rio local' },

            // ---- Neuro ----
            neuroTitle:         { en: 'ğŸ§  Daily Brain Insight', fr: 'ğŸ§  Astuce cÃ©rÃ©brale du jour', pt: 'ğŸ§  Curiosidade cerebral do dia' },

            // ---- Footer ----
            footerText:         { en: 'Connecting two homes across the Atlantic', fr: "Connecter deux foyers Ã  travers l'Atlantique", pt: 'A ligar duas casas atravÃ©s do AtlÃ¢ntico' },

            // ---- WMO Weather descriptions ----
            wmo0:  { en: 'Clear sky', fr: 'Ciel dÃ©gagÃ©', pt: 'CÃ©u limpo' },
            wmo1:  { en: 'Mainly clear', fr: 'Principalement dÃ©gagÃ©', pt: 'Predominantemente limpo' },
            wmo2:  { en: 'Partly cloudy', fr: 'Partiellement nuageux', pt: 'Parcialmente nublado' },
            wmo3:  { en: 'Overcast', fr: 'Couvert', pt: 'Encoberto' },
            wmo45: { en: 'Fog', fr: 'Brouillard', pt: 'Nevoeiro' },
            wmo48: { en: 'Depositing rime fog', fr: 'Brouillard givrant', pt: 'Nevoeiro com geada' },
            wmo51: { en: 'Light drizzle', fr: 'Bruine lÃ©gÃ¨re', pt: 'Chuviscos leves' },
            wmo53: { en: 'Moderate drizzle', fr: 'Bruine modÃ©rÃ©e', pt: 'Chuviscos moderados' },
            wmo55: { en: 'Dense drizzle', fr: 'Bruine dense', pt: 'Chuviscos intensos' },
            wmo61: { en: 'Slight rain', fr: 'Pluie lÃ©gÃ¨re', pt: 'Chuva fraca' },
            wmo63: { en: 'Moderate rain', fr: 'Pluie modÃ©rÃ©e', pt: 'Chuva moderada' },
            wmo65: { en: 'Heavy rain', fr: 'Pluie forte', pt: 'Chuva forte' },
            wmo71: { en: 'Slight snow', fr: 'Neige lÃ©gÃ¨re', pt: 'Neve fraca' },
            wmo73: { en: 'Moderate snow', fr: 'Neige modÃ©rÃ©e', pt: 'Neve moderada' },
            wmo75: { en: 'Heavy snow', fr: 'Neige forte', pt: 'Neve forte' },
            wmo77: { en: 'Snow grains', fr: 'Grains de neige', pt: 'GrÃ£os de neve' },
            wmo80: { en: 'Slight showers', fr: 'Averses lÃ©gÃ¨res', pt: 'Aguaceiros fracos' },
            wmo81: { en: 'Moderate showers', fr: 'Averses modÃ©rÃ©es', pt: 'Aguaceiros moderados' },
            wmo82: { en: 'Violent showers', fr: 'Averses violentes', pt: 'Aguaceiros fortes' },
            wmo85: { en: 'Slight snow showers', fr: 'Averses de neige lÃ©gÃ¨res', pt: 'Aguaceiros de neve fracos' },
            wmo86: { en: 'Heavy snow showers', fr: 'Averses de neige fortes', pt: 'Aguaceiros de neve fortes' },
            wmo95: { en: 'Thunderstorm', fr: 'Orage', pt: 'Trovoada' },
            wmo96: { en: 'Thunderstorm with slight hail', fr: 'Orage avec grÃªle lÃ©gÃ¨re', pt: 'Trovoada com granizo fraco' },
            wmo99: { en: 'Thunderstorm with heavy hail', fr: 'Orage avec forte grÃªle', pt: 'Trovoada com granizo forte' },
        };

        // ---- "What's Happening" texts per language ----
        const happeningCV = {
            en: [
                { start: 0, end: 5, emoji: 'ğŸŒ™', text: 'Mindelo is sleeping under the Atlantic stars' },
                { start: 5, end: 7, emoji: 'ğŸŒ…', text: 'Early risers in Mindelo are watching the sunrise over the bay' },
                { start: 7, end: 9, emoji: 'â˜•', text: 'Mindelo is waking up â€” coffee and fresh bread at the padaria' },
                { start: 9, end: 11, emoji: 'ğŸª', text: 'The Mercado Municipal is buzzing with fresh fish and produce' },
                { start: 11, end: 12, emoji: 'ğŸµ', text: 'Morna music drifts through the streets of Mindelo' },
                { start: 12, end: 14, emoji: 'ğŸ½ï¸', text: 'Your family in Mindelo is having lunch â€” cachupa is on the table' },
                { start: 14, end: 16, emoji: 'ğŸŒŠ', text: 'Afternoon in Mindelo â€” perfect time for a walk along Laginha beach' },
                { start: 16, end: 18, emoji: 'âš½', text: 'Kids are playing football on the streets of Mindelo' },
                { start: 18, end: 19, emoji: 'ğŸŒ‡', text: 'Golden hour in Mindelo â€” the bay glows with warm light' },
                { start: 19, end: 20, emoji: 'ğŸ·', text: 'Grogue time â€” Mindelo is settling into the evening' },
                { start: 20, end: 21, emoji: 'ğŸ¶', text: 'Live music fills the bars along Rua de Lisboa' },
                { start: 21, end: 23, emoji: 'ğŸŒƒ', text: "Mindelo nightlife is coming alive â€” the city of CesÃ¡ria Ã‰vora never sleeps early" },
                { start: 23, end: 24, emoji: 'ğŸŒ™', text: 'Late night in Mindelo â€” the Atlantic breeze cools the city' }
            ],
            fr: [
                { start: 0, end: 5, emoji: 'ğŸŒ™', text: 'Mindelo dort sous les Ã©toiles de l\'Atlantique' },
                { start: 5, end: 7, emoji: 'ğŸŒ…', text: 'Les lÃ¨ve-tÃ´t de Mindelo regardent le lever du soleil sur la baie' },
                { start: 7, end: 9, emoji: 'â˜•', text: 'Mindelo se rÃ©veille â€” cafÃ© et pain frais Ã  la padaria' },
                { start: 9, end: 11, emoji: 'ğŸª', text: 'Le Mercado Municipal est animÃ© â€” poissons frais et lÃ©gumes' },
                { start: 11, end: 12, emoji: 'ğŸµ', text: 'La morna rÃ©sonne dans les rues de Mindelo' },
                { start: 12, end: 14, emoji: 'ğŸ½ï¸', text: 'Votre famille Ã  Mindelo dÃ©jeune â€” la cachupa est sur la table' },
                { start: 14, end: 16, emoji: 'ğŸŒŠ', text: 'AprÃ¨s-midi Ã  Mindelo â€” parfait pour une promenade sur la plage de Laginha' },
                { start: 16, end: 18, emoji: 'âš½', text: 'Les enfants jouent au football dans les rues de Mindelo' },
                { start: 18, end: 19, emoji: 'ğŸŒ‡', text: 'Heure dorÃ©e Ã  Mindelo â€” la baie brille de lumiÃ¨re chaude' },
                { start: 19, end: 20, emoji: 'ğŸ·', text: 'L\'heure du grogue â€” Mindelo s\'installe dans la soirÃ©e' },
                { start: 20, end: 21, emoji: 'ğŸ¶', text: 'La musique live remplit les bars de la Rua de Lisboa' },
                { start: 21, end: 23, emoji: 'ğŸŒƒ', text: 'La vie nocturne de Mindelo s\'anime â€” la ville de CesÃ¡ria Ã‰vora ne dort jamais tÃ´t' },
                { start: 23, end: 24, emoji: 'ğŸŒ™', text: 'Nuit tardive Ã  Mindelo â€” la brise atlantique rafraÃ®chit la ville' }
            ],
            pt: [
                { start: 0, end: 5, emoji: 'ğŸŒ™', text: 'Mindelo dorme sob as estrelas do AtlÃ¢ntico' },
                { start: 5, end: 7, emoji: 'ğŸŒ…', text: 'Os madrugadores de Mindelo observam o nascer do sol sobre a baÃ­a' },
                { start: 7, end: 9, emoji: 'â˜•', text: 'Mindelo acorda â€” cafÃ© e pÃ£o fresco na padaria' },
                { start: 9, end: 11, emoji: 'ğŸª', text: 'O Mercado Municipal estÃ¡ animado â€” peixe fresco e produtos da terra' },
                { start: 11, end: 12, emoji: 'ğŸµ', text: 'A morna flui pelas ruas de Mindelo' },
                { start: 12, end: 14, emoji: 'ğŸ½ï¸', text: 'A sua famÃ­lia em Mindelo estÃ¡ a almoÃ§ar â€” cachupa na mesa' },
                { start: 14, end: 16, emoji: 'ğŸŒŠ', text: 'Tarde em Mindelo â€” perfeito para um passeio pela praia de Laginha' },
                { start: 16, end: 18, emoji: 'âš½', text: 'Os miÃºdos jogam futebol nas ruas de Mindelo' },
                { start: 18, end: 19, emoji: 'ğŸŒ‡', text: 'Hora dourada em Mindelo â€” a baÃ­a brilha com luz quente' },
                { start: 19, end: 20, emoji: 'ğŸ·', text: 'Hora do grogue â€” Mindelo entra pela noite' },
                { start: 20, end: 21, emoji: 'ğŸ¶', text: 'MÃºsica ao vivo enche os bares da Rua de Lisboa' },
                { start: 21, end: 23, emoji: 'ğŸŒƒ', text: 'A vida nocturna de Mindelo ganha vida â€” a cidade de CesÃ¡ria Ã‰vora nunca dorme cedo' },
                { start: 23, end: 24, emoji: 'ğŸŒ™', text: 'Noite avanÃ§ada em Mindelo â€” a brisa atlÃ¢ntica refresca a cidade' }
            ]
        };

        const happeningCH = {
            en: [
                { start: 0, end: 5, emoji: 'ğŸŒ™', text: 'Lausanne is asleep â€” the Alps stand guard in the moonlight' },
                { start: 5, end: 7, emoji: 'ğŸ”ï¸', text: 'Dawn breaks over Lake Geneva and the Alpine peaks' },
                { start: 7, end: 9, emoji: 'ğŸ¥', text: 'Lausanne is having breakfast â€” croissants and cafÃ© au lait' },
                { start: 9, end: 11, emoji: 'ğŸ’¼', text: 'The workday is underway in Lausanne â€” EPFL buzzes with ideas' },
                { start: 11, end: 12, emoji: 'ğŸ“š', text: 'Mid-morning in Lausanne â€” labs and lectures in full swing' },
                { start: 12, end: 13, emoji: 'ğŸ§€', text: 'Lunch break in Lausanne â€” fondue or a lakeside sandwich' },
                { start: 13, end: 15, emoji: 'ğŸ¢', text: 'Afternoon productivity in Lausanne â€” the Swiss clockwork keeps ticking' },
                { start: 15, end: 16, emoji: 'â˜•', text: 'Coffee break in Lausanne â€” time for a quick espresso' },
                { start: 16, end: 18, emoji: 'ğŸš¶', text: 'Lausanne winds down â€” people stroll along the Ouchy waterfront' },
                { start: 18, end: 19, emoji: 'ğŸ ', text: 'Heading home in Lausanne â€” the MÃ©tro carries commuters uphill' },
                { start: 19, end: 21, emoji: 'ğŸ·', text: 'Lausanne is winding down for the evening â€” dinner time with Swiss wine' },
                { start: 21, end: 22, emoji: 'ğŸ“–', text: 'Quiet evening in Lausanne â€” reading by the window with lake views' },
                { start: 22, end: 24, emoji: 'ğŸŒ™', text: 'Lausanne is settling in for the night â€” bonne nuit!' }
            ],
            fr: [
                { start: 0, end: 5, emoji: 'ğŸŒ™', text: 'Lausanne dort â€” les Alpes veillent au clair de lune' },
                { start: 5, end: 7, emoji: 'ğŸ”ï¸', text: 'L\'aube se lÃ¨ve sur le lac LÃ©man et les sommets alpins' },
                { start: 7, end: 9, emoji: 'ğŸ¥', text: 'Lausanne prend le petit-dÃ©jeuner â€” croissants et cafÃ© au lait' },
                { start: 9, end: 11, emoji: 'ğŸ’¼', text: 'La journÃ©e de travail bat son plein Ã  Lausanne â€” l\'EPFL bouillonne d\'idÃ©es' },
                { start: 11, end: 12, emoji: 'ğŸ“š', text: 'Mi-matinÃ©e Ã  Lausanne â€” labos et cours Ã  plein rÃ©gime' },
                { start: 12, end: 13, emoji: 'ğŸ§€', text: 'Pause dÃ©jeuner Ã  Lausanne â€” fondue ou sandwich au bord du lac' },
                { start: 13, end: 15, emoji: 'ğŸ¢', text: 'ProductivitÃ© de l\'aprÃ¨s-midi Ã  Lausanne â€” la mÃ©canique suisse tourne' },
                { start: 15, end: 16, emoji: 'â˜•', text: 'Pause cafÃ© Ã  Lausanne â€” un petit espresso' },
                { start: 16, end: 18, emoji: 'ğŸš¶', text: 'Lausanne ralentit â€” les gens se promÃ¨nent le long du quai d\'Ouchy' },
                { start: 18, end: 19, emoji: 'ğŸ ', text: 'Retour Ã  la maison Ã  Lausanne â€” le MÃ©tro remonte les pendulaires' },
                { start: 19, end: 21, emoji: 'ğŸ·', text: 'Lausanne se dÃ©tend â€” l\'heure du dÃ®ner avec un vin suisse' },
                { start: 21, end: 22, emoji: 'ğŸ“–', text: 'SoirÃ©e tranquille Ã  Lausanne â€” lecture avec vue sur le lac' },
                { start: 22, end: 24, emoji: 'ğŸŒ™', text: 'Lausanne s\'endort â€” bonne nuit !' }
            ],
            pt: [
                { start: 0, end: 5, emoji: 'ğŸŒ™', text: 'Lausanne dorme â€” os Alpes vigiam ao luar' },
                { start: 5, end: 7, emoji: 'ğŸ”ï¸', text: 'A aurora nasce sobre o Lago LÃ©man e os picos alpinos' },
                { start: 7, end: 9, emoji: 'ğŸ¥', text: 'Lausanne toma o pequeno-almoÃ§o â€” croissants e cafÃ© com leite' },
                { start: 9, end: 11, emoji: 'ğŸ’¼', text: 'O dia de trabalho arranca em Lausanne â€” a EPFL fervilha de ideias' },
                { start: 11, end: 12, emoji: 'ğŸ“š', text: 'Meio da manhÃ£ em Lausanne â€” laboratÃ³rios e aulas a todo o vapor' },
                { start: 12, end: 13, emoji: 'ğŸ§€', text: 'Pausa para almoÃ§o em Lausanne â€” fondue ou sanduÃ­che Ã  beira do lago' },
                { start: 13, end: 15, emoji: 'ğŸ¢', text: 'Tarde produtiva em Lausanne â€” o mecanismo suÃ­Ã§o continua a funcionar' },
                { start: 15, end: 16, emoji: 'â˜•', text: 'Pausa para cafÃ© em Lausanne â€” hora de um espresso rÃ¡pido' },
                { start: 16, end: 18, emoji: 'ğŸš¶', text: 'Lausanne abranda â€” as pessoas passeiam pelo cais de Ouchy' },
                { start: 18, end: 19, emoji: 'ğŸ ', text: 'A caminho de casa em Lausanne â€” o MÃ©tro leva os pendulares colina acima' },
                { start: 19, end: 21, emoji: 'ğŸ·', text: 'Lausanne relaxa ao fim do dia â€” hora de jantar com vinho suÃ­Ã§o' },
                { start: 21, end: 22, emoji: 'ğŸ“–', text: 'Noite tranquila em Lausanne â€” leitura com vista para o lago' },
                { start: 22, end: 24, emoji: 'ğŸŒ™', text: 'Lausanne adormece â€” bonne nuit!' }
            ]
        };

        // ---- Neuroscience Tips per language ----
        const neuroTips = {
            en: [
                { category: 'Circadian Rhythms', emoji: 'ğŸŒ…', tip: "Your body's master clock â€” the suprachiasmatic nucleus â€” is only about the size of a grain of rice, yet it orchestrates the timing of nearly every cell in your body. Morning sunlight is its most powerful calibrator.", source: 'Chronobiology research' },
                { category: 'Jet Lag Science', emoji: 'âœˆï¸', tip: "Travelling east (like Mindelo â†’ Lausanne) is harder on your body than going west. Your internal clock naturally runs slightly longer than 24 hours, making it easier to extend your day than shorten it.", source: 'Sleep medicine research' },
                { category: 'Time Perception', emoji: 'â³', tip: "Time feels slower when you're experiencing new things. That's why holidays feel long but routine weeks fly by. Your brain creates more detailed memories for novel experiences, making them seem to last longer in retrospect.", source: 'Cognitive neuroscience' },
                { category: 'Sleep Science', emoji: 'ğŸ˜´', tip: "During deep sleep, your brain's glymphatic system flushes out metabolic waste â€” including proteins linked to Alzheimer's. Think of sleep as your brain's nightly cleaning service.", source: 'Neuroscience of sleep' },
                { category: 'Social Jetlag', emoji: 'â°', tip: "Staying up late on weekends and sleeping in creates \"social jetlag\" â€” your body experiences it much like crossing time zones. Keeping a consistent sleep schedule, even on weekends, benefits your health.", source: 'Chronobiology research' },
                { category: 'Light & Mood', emoji: 'ğŸ’¡', tip: "Blue light from screens suppresses melatonin production, but it's not just about sleep â€” light exposure patterns throughout the day also affect mood, alertness, and even immune function.", source: 'Photobiology research' },
                { category: 'Nostalgia & Time', emoji: 'ğŸµ', tip: "Music heard between ages 12-22 tends to stick with us the strongest. This \"reminiscence bump\" happens because your brain encodes memories more intensely during periods of identity formation.", source: 'Memory research' },
                { category: 'Body Temperature', emoji: 'ğŸŒ¡ï¸', tip: "Your body temperature follows a circadian rhythm, dropping about 1-1.5Â°C at night. This cooling is a signal to your brain that it's time to sleep â€” a cool bedroom (around 18Â°C) supports better rest.", source: 'Thermoregulation studies' },
                { category: 'Chronotypes', emoji: 'ğŸ¦‰', tip: "Whether you're a morning lark or night owl is largely genetic. About 25% of people are strong morning types, 25% strong evening types, and the rest fall somewhere in between.", source: 'Behavioral genetics' },
                { category: 'Napping Science', emoji: 'ğŸ’¤', tip: 'A 20-minute nap boosts alertness and performance without grogginess. Longer naps (90 minutes) allow a full sleep cycle and can enhance creativity and emotional memory.', source: 'Sleep research' },
                { category: 'Sodade & The Brain', emoji: 'ğŸ’™', tip: "Longing for home activates brain regions associated with reward and motivation â€” not just sadness. Sodade, that deeply Cabo Verdean feeling, is your brain's way of keeping important social bonds alive.", source: 'Social neuroscience' },
                { category: 'Bilingual Brains', emoji: 'ğŸ§ ', tip: 'Speaking multiple languages (like Kriolu and French) strengthens executive function and may delay cognitive decline. Each language activates slightly different neural networks, keeping your brain more flexible.', source: 'Neurolinguistics' },
                { category: 'Altitude & Cognition', emoji: 'ğŸ”ï¸', tip: "Living at altitude (like visits to the Swiss Alps) temporarily affects cognition due to lower oxygen. But regular exposure improves your body's oxygen efficiency â€” mountain air literally sharpens your blood.", source: 'High-altitude physiology' },
                { category: 'Ocean & Wellbeing', emoji: 'ğŸŒŠ', tip: "Being near the ocean â€” like in Mindelo â€” reduces cortisol and increases serotonin. The sound of waves alters brain wave patterns, promoting a meditative state. It's called \"blue mind\" science.", source: 'Environmental neuroscience' },
                { category: 'Food & Brain Clocks', emoji: 'ğŸ½ï¸', tip: "When you eat matters almost as much as what you eat for your circadian health. Regular meal times help synchronize peripheral body clocks in your liver, gut, and muscles with your brain's master clock.", source: 'Chrononutrition research' }
            ],
            fr: [
                { category: 'Rythmes circadiens', emoji: 'ğŸŒ…', tip: "L'horloge maÃ®tre de votre corps â€” le noyau suprachiasmatique â€” ne fait que la taille d'un grain de riz, mais orchestre le rythme de presque chaque cellule. La lumiÃ¨re du matin est son calibrateur le plus puissant.", source: 'Recherche en chronobiologie' },
                { category: 'Science du jet lag', emoji: 'âœˆï¸', tip: "Voyager vers l'est (comme Mindelo â†’ Lausanne) est plus difficile pour le corps que vers l'ouest. Votre horloge interne fonctionne naturellement un peu plus de 24 heures, ce qui rend plus facile d'allonger votre journÃ©e que de la raccourcir.", source: 'MÃ©decine du sommeil' },
                { category: 'Perception du temps', emoji: 'â³', tip: "Le temps semble plus lent quand on vit de nouvelles expÃ©riences. C'est pourquoi les vacances semblent longues mais les semaines de routine filent. Votre cerveau crÃ©e des souvenirs plus dÃ©taillÃ©s pour les expÃ©riences nouvelles.", source: 'Neurosciences cognitives' },
                { category: 'Science du sommeil', emoji: 'ğŸ˜´', tip: "Pendant le sommeil profond, le systÃ¨me glymphatique de votre cerveau Ã©vacue les dÃ©chets mÃ©taboliques â€” y compris les protÃ©ines liÃ©es Ã  Alzheimer. Pensez au sommeil comme au service de nettoyage nocturne de votre cerveau.", source: 'Neurosciences du sommeil' },
                { category: 'Jet lag social', emoji: 'â°', tip: "Se coucher tard le week-end crÃ©e un Â« jet lag social Â» â€” votre corps le ressent comme un dÃ©calage horaire. Garder un horaire de sommeil rÃ©gulier, mÃªme le week-end, est bÃ©nÃ©fique pour votre santÃ©.", source: 'Recherche en chronobiologie' },
                { category: 'LumiÃ¨re & humeur', emoji: 'ğŸ’¡', tip: "La lumiÃ¨re bleue des Ã©crans supprime la production de mÃ©latonine, mais ce n'est pas qu'une question de sommeil â€” les schÃ©mas d'exposition Ã  la lumiÃ¨re affectent aussi l'humeur, la vigilance et mÃªme la fonction immunitaire.", source: 'Recherche en photobiologie' },
                { category: 'Nostalgie & temps', emoji: 'ğŸµ', tip: "La musique entendue entre 12 et 22 ans reste la plus marquante. Ce Â« pic de rÃ©miniscence Â» se produit parce que le cerveau encode les souvenirs plus intensÃ©ment pendant les pÃ©riodes de formation de l'identitÃ©.", source: 'Recherche sur la mÃ©moire' },
                { category: 'TempÃ©rature corporelle', emoji: 'ğŸŒ¡ï¸', tip: "Votre tempÃ©rature corporelle suit un rythme circadien, baissant d'environ 1 Ã  1,5Â°C la nuit. Ce refroidissement signale au cerveau qu'il est temps de dormir â€” une chambre fraÃ®che (environ 18Â°C) favorise un meilleur repos.", source: 'Ã‰tudes sur la thermorÃ©gulation' },
                { category: 'Chronotypes', emoji: 'ğŸ¦‰', tip: "ÃŠtre lÃ¨ve-tÃ´t ou couche-tard est en grande partie gÃ©nÃ©tique. Environ 25% des gens sont de forts types matinaux, 25% de forts types vespÃ©raux, et le reste se situe entre les deux.", source: 'GÃ©nÃ©tique comportementale' },
                { category: 'Science de la sieste', emoji: 'ğŸ’¤', tip: "Une sieste de 20 minutes amÃ©liore la vigilance et les performances sans somnolence. Les siestes plus longues (90 minutes) permettent un cycle de sommeil complet et peuvent stimuler la crÃ©ativitÃ© et la mÃ©moire Ã©motionnelle.", source: 'Recherche sur le sommeil' },
                { category: 'Sodade & le cerveau', emoji: 'ğŸ’™', tip: "Le mal du pays active les rÃ©gions du cerveau associÃ©es Ã  la rÃ©compense et Ã  la motivation â€” pas seulement Ã  la tristesse. La sodade, ce sentiment profondÃ©ment cap-verdien, est la faÃ§on dont votre cerveau maintient les liens sociaux importants.", source: 'Neurosciences sociales' },
                { category: 'Cerveaux bilingues', emoji: 'ğŸ§ ', tip: "Parler plusieurs langues (comme le crÃ©ole et le franÃ§ais) renforce les fonctions exÃ©cutives et peut retarder le dÃ©clin cognitif. Chaque langue active des rÃ©seaux neuronaux lÃ©gÃ¨rement diffÃ©rents, gardant votre cerveau plus flexible.", source: 'Neurolinguistique' },
                { category: 'Altitude & cognition', emoji: 'ğŸ”ï¸', tip: "Vivre en altitude (comme les Alpes suisses) affecte temporairement la cognition Ã  cause du manque d'oxygÃ¨ne. Mais une exposition rÃ©guliÃ¨re amÃ©liore l'efficacitÃ© de l'oxygÃ©nation â€” l'air de la montagne aiguise littÃ©ralement votre sang.", source: 'Physiologie de haute altitude' },
                { category: 'OcÃ©an & bien-Ãªtre', emoji: 'ğŸŒŠ', tip: "ÃŠtre prÃ¨s de l'ocÃ©an â€” comme Ã  Mindelo â€” rÃ©duit le cortisol et augmente la sÃ©rotonine. Le son des vagues modifie les ondes cÃ©rÃ©brales, favorisant un Ã©tat mÃ©ditatif. C'est la science du Â« blue mind Â».", source: 'Neurosciences environnementales' },
                { category: 'Alimentation & horloges', emoji: 'ğŸ½ï¸', tip: "Quand vous mangez compte presque autant que ce que vous mangez pour votre santÃ© circadienne. Des repas rÃ©guliers synchronisent les horloges pÃ©riphÃ©riques du foie, de l'intestin et des muscles avec l'horloge maÃ®tre du cerveau.", source: 'Recherche en chrononutrition' }
            ],
            pt: [
                { category: 'Ritmos circadianos', emoji: 'ğŸŒ…', tip: "O relÃ³gio-mestre do seu corpo â€” o nÃºcleo supraquiasmÃ¡tico â€” tem apenas o tamanho de um grÃ£o de arroz, mas orquestra o ritmo de quase todas as cÃ©lulas do corpo. A luz da manhÃ£ Ã© o seu calibrador mais poderoso.", source: 'InvestigaÃ§Ã£o em cronobiologia' },
                { category: 'CiÃªncia do jet lag', emoji: 'âœˆï¸', tip: "Viajar para leste (como Mindelo â†’ Lausanne) Ã© mais difÃ­cil para o corpo do que para oeste. O relÃ³gio interno funciona naturalmente um pouco mais de 24 horas, tornando mais fÃ¡cil prolongar o dia do que encurtÃ¡-lo.", source: 'Medicina do sono' },
                { category: 'PerceÃ§Ã£o do tempo', emoji: 'â³', tip: "O tempo parece mais lento quando vivemos experiÃªncias novas. Por isso as fÃ©rias parecem longas e as semanas de rotina passam a correr. O cÃ©rebro cria memÃ³rias mais detalhadas para experiÃªncias novas, fazendo-as parecer mais longas.", source: 'NeurociÃªncia cognitiva' },
                { category: 'CiÃªncia do sono', emoji: 'ğŸ˜´', tip: "Durante o sono profundo, o sistema glinfÃ¡tico do cÃ©rebro elimina resÃ­duos metabÃ³licos â€” incluindo proteÃ­nas ligadas ao Alzheimer. Pense no sono como o serviÃ§o de limpeza nocturno do seu cÃ©rebro.", source: 'NeurociÃªncia do sono' },
                { category: 'Jet lag social', emoji: 'â°', tip: "Ficar acordado atÃ© tarde ao fim de semana cria Â« jet lag social Â» â€” o corpo sente-o como mudar de fuso horÃ¡rio. Manter um horÃ¡rio de sono regular, mesmo ao fim de semana, beneficia a sua saÃºde.", source: 'InvestigaÃ§Ã£o em cronobiologia' },
                { category: 'Luz & humor', emoji: 'ğŸ’¡', tip: "A luz azul dos ecrÃ£s suprime a produÃ§Ã£o de melatonina, mas nÃ£o Ã© sÃ³ uma questÃ£o de sono â€” os padrÃµes de exposiÃ§Ã£o Ã  luz ao longo do dia afectam tambÃ©m o humor, a atenÃ§Ã£o e atÃ© a funÃ§Ã£o imunitÃ¡ria.", source: 'InvestigaÃ§Ã£o em fotobiologia' },
                { category: 'Nostalgia & tempo', emoji: 'ğŸµ', tip: "A mÃºsica ouvida entre os 12 e os 22 anos marca-nos mais. Este Â« pico de reminiscÃªncia Â» acontece porque o cÃ©rebro codifica memÃ³rias mais intensamente durante os perÃ­odos de formaÃ§Ã£o da identidade.", source: 'InvestigaÃ§Ã£o sobre memÃ³ria' },
                { category: 'Temperatura corporal', emoji: 'ğŸŒ¡ï¸', tip: "A temperatura corporal segue um ritmo circadiano, baixando cerca de 1 a 1,5Â°C Ã  noite. Este arrefecimento sinaliza ao cÃ©rebro que Ã© hora de dormir â€” um quarto fresco (cerca de 18Â°C) favorece um melhor descanso.", source: 'Estudos de termorregulaÃ§Ã£o' },
                { category: 'Cronotipos', emoji: 'ğŸ¦‰', tip: "Ser madrugador ou noctÃ­vago Ã© em grande parte genÃ©tico. Cerca de 25% das pessoas sÃ£o fortemente matutinas, 25% fortemente vespertinas, e o resto situa-se algures entre os dois.", source: 'GenÃ©tica comportamental' },
                { category: 'CiÃªncia da sesta', emoji: 'ğŸ’¤', tip: "Uma sesta de 20 minutos melhora a atenÃ§Ã£o e o desempenho sem sonolÃªncia. Sestas mais longas (90 minutos) permitem um ciclo completo de sono e podem estimular a criatividade e a memÃ³ria emocional.", source: 'InvestigaÃ§Ã£o sobre o sono' },
                { category: 'Sodade & o cÃ©rebro', emoji: 'ğŸ’™', tip: "A saudade de casa activa regiÃµes cerebrais associadas Ã  recompensa e motivaÃ§Ã£o â€” nÃ£o apenas Ã  tristeza. A sodade, esse sentimento profundamente cabo-verdiano, Ã© a forma do cÃ©rebro manter os laÃ§os sociais importantes.", source: 'NeurociÃªncia social' },
                { category: 'CÃ©rebros bilingues', emoji: 'ğŸ§ ', tip: "Falar vÃ¡rias lÃ­nguas (como o crioulo e o francÃªs) fortalece as funÃ§Ãµes executivas e pode atrasar o declÃ­nio cognitivo. Cada lÃ­ngua activa redes neuronais ligeiramente diferentes, mantendo o cÃ©rebro mais flexÃ­vel.", source: 'NeurolinguÃ­stica' },
                { category: 'Altitude & cogniÃ§Ã£o', emoji: 'ğŸ”ï¸', tip: "Viver em altitude (como nos Alpes suÃ­Ã§os) afecta temporariamente a cogniÃ§Ã£o devido ao menor oxigÃ©nio. Mas a exposiÃ§Ã£o regular melhora a eficiÃªncia do oxigÃ©nio â€” o ar da montanha afia literalmente o sangue.", source: 'Fisiologia de alta altitude' },
                { category: 'Oceano & bem-estar', emoji: 'ğŸŒŠ', tip: "Estar perto do oceano â€” como em Mindelo â€” reduz o cortisol e aumenta a serotonina. O som das ondas altera os padrÃµes de ondas cerebrais, promovendo um estado meditativo. Ã‰ a ciÃªncia do Â« blue mind Â».", source: 'NeurociÃªncia ambiental' },
                { category: 'AlimentaÃ§Ã£o & relÃ³gios', emoji: 'ğŸ½ï¸', tip: "Quando se come importa quase tanto como o que se come para a saÃºde circadiana. RefeiÃ§Ãµes regulares ajudam a sincronizar os relÃ³gios perifÃ©ricos do fÃ­gado, intestino e mÃºsculos com o relÃ³gio-mestre do cÃ©rebro.", source: 'InvestigaÃ§Ã£o em cronoNutriÃ§Ã£o' }
            ]
        };

        // ---- Calendar event descriptions per language ----
        function getCulturalEvents() {
            const year = new Date().getFullYear();
            const easter = getEasterDate(year);

            const shroveTuesday = addDays(easter, -47);
            const ashWednesday = addDays(easter, -46);
            const goodFriday = addDays(easter, -2);
            const easterMonday = addDays(easter, 1);
            const ascension = addDays(easter, 39);
            const whitMonday = addDays(easter, 50);
            const federalFast = getFederalFastMonday(year);

            const cvEvents = {
                en: [
                    { date: `${year}-01-01`, name: "Ano Novo", desc: "New Year's Day â€” celebrations across the islands" },
                    { date: `${year}-01-13`, name: "Dia da Liberdade e Democracia", desc: "Freedom and Democracy Day" },
                    { date: `${year}-01-20`, name: "Dia dos HerÃ³is Nacionais", desc: "National Heroes' Day â€” honouring AmÃ­lcar Cabral" },
                    { date: `${year}-01-22`, name: "Dia de SÃ£o Vicente", desc: "SÃ£o Vicente island day â€” concerts on Rua de Lisboa" },
                    { date: fmt(addDays(shroveTuesday, -21)), name: "Mandingas Begin", desc: "Sunday parades of Mandingas tradition start in Mindelo" },
                    { date: fmt(shroveTuesday), name: "Carnaval â€” TerÃ§a de Entrudo", desc: "Shrove Tuesday â€” Mindelo's main Carnival parade, the biggest in Cabo Verde" },
                    { date: fmt(ashWednesday), name: "Quarta-feira de Cinzas", desc: "Ash Wednesday â€” national holiday, Carnival awards ceremony" },
                    { date: fmt(goodFriday), name: "Sexta-feira Santa", desc: "Good Friday" },
                    { date: `${year}-05-01`, name: "Dia do Trabalhador", desc: "Labour Day" },
                    { date: `${year}-06-01`, name: "Dia da CrianÃ§a", desc: "Children's Day â€” festivities across the islands" },
                    { date: `${year}-06-24`, name: "SÃ£o JoÃ£o â€” Kola San Djon", desc: "Midsummer festival in Ribeira de JuliÃ£o â€” music, drumming, fire-jumping" },
                    { date: `${year}-07-05`, name: "Dia da IndependÃªncia", desc: "Independence Day â€” Cabo Verde's national day, major concerts" },
                    { date: `${year}-08-15`, name: "Nossa Senhora da GraÃ§a", desc: "Assumption of Mary â€” patron saint festivities" },
                    { date: `${year}-08-15`, name: "BaÃ­a das Gatas Festival", desc: "Free open-air beach music festival near Mindelo (full moon weekend in August)" },
                    { date: `${year}-09-12`, name: "Dia da NaÃ§Ã£o", desc: "Nationality Day â€” celebrating Cabo Verdean identity and culture" },
                    { date: `${year}-10-01`, name: "Mindelact", desc: "International theatre festival in Mindelo (September/October)" },
                    { date: `${year}-11-01`, name: "Dia de Todos os Santos", desc: "All Saints' Day" },
                    { date: `${year}-12-25`, name: "Natal", desc: "Christmas Day â€” family gatherings and festive food" },
                    { date: `${year}-12-31`, name: "RÃ©veillon", desc: "New Year's Eve â€” major concert on Rua de Lisboa" }
                ],
                fr: [
                    { date: `${year}-01-01`, name: "Ano Novo", desc: "Jour de l'An â€” cÃ©lÃ©brations Ã  travers les Ã®les" },
                    { date: `${year}-01-13`, name: "Dia da Liberdade e Democracia", desc: "Jour de la LibertÃ© et de la DÃ©mocratie" },
                    { date: `${year}-01-20`, name: "Dia dos HerÃ³is Nacionais", desc: "Jour des HÃ©ros Nationaux â€” en l'honneur d'AmÃ­lcar Cabral" },
                    { date: `${year}-01-22`, name: "Dia de SÃ£o Vicente", desc: "FÃªte de l'Ã®le de SÃ£o Vicente â€” concerts sur la Rua de Lisboa" },
                    { date: fmt(addDays(shroveTuesday, -21)), name: "DÃ©but des Mandingas", desc: "Les dÃ©filÃ©s dominicaux de la tradition des Mandingas commencent Ã  Mindelo" },
                    { date: fmt(shroveTuesday), name: "Carnaval â€” TerÃ§a de Entrudo", desc: "Mardi gras â€” le plus grand dÃ©filÃ© de Carnaval du Cabo Verde Ã  Mindelo" },
                    { date: fmt(ashWednesday), name: "Quarta-feira de Cinzas", desc: "Mercredi des Cendres â€” jour fÃ©riÃ©, cÃ©rÃ©monie de remise des prix du Carnaval" },
                    { date: fmt(goodFriday), name: "Sexta-feira Santa", desc: "Vendredi Saint" },
                    { date: `${year}-05-01`, name: "Dia do Trabalhador", desc: "FÃªte du Travail" },
                    { date: `${year}-06-01`, name: "Dia da CrianÃ§a", desc: "JournÃ©e des enfants â€” festivitÃ©s Ã  travers les Ã®les" },
                    { date: `${year}-06-24`, name: "SÃ£o JoÃ£o â€” Kola San Djon", desc: "Festival de la Saint-Jean Ã  Ribeira de JuliÃ£o â€” musique, percussions, sauts de feu" },
                    { date: `${year}-07-05`, name: "Dia da IndependÃªncia", desc: "Jour de l'IndÃ©pendance â€” fÃªte nationale, grands concerts" },
                    { date: `${year}-08-15`, name: "Nossa Senhora da GraÃ§a", desc: "Assomption de Marie â€” fÃªtes patronales" },
                    { date: `${year}-08-15`, name: "BaÃ­a das Gatas Festival", desc: "Festival de musique en plein air gratuit prÃ¨s de Mindelo (week-end de pleine lune en aoÃ»t)" },
                    { date: `${year}-09-12`, name: "Dia da NaÃ§Ã£o", desc: "Jour de la Nation â€” cÃ©lÃ©bration de l'identitÃ© et la culture cap-verdiennes" },
                    { date: `${year}-10-01`, name: "Mindelact", desc: "Festival international de thÃ©Ã¢tre Ã  Mindelo (septembre/octobre)" },
                    { date: `${year}-11-01`, name: "Dia de Todos os Santos", desc: "Toussaint" },
                    { date: `${year}-12-25`, name: "Natal", desc: "NoÃ«l â€” repas de famille et ambiance festive" },
                    { date: `${year}-12-31`, name: "RÃ©veillon", desc: "RÃ©veillon du Nouvel An â€” grand concert sur la Rua de Lisboa" }
                ],
                pt: [
                    { date: `${year}-01-01`, name: "Ano Novo", desc: "Dia de Ano Novo â€” celebraÃ§Ãµes por todas as ilhas" },
                    { date: `${year}-01-13`, name: "Dia da Liberdade e Democracia", desc: "Dia da Liberdade e da Democracia" },
                    { date: `${year}-01-20`, name: "Dia dos HerÃ³is Nacionais", desc: "Dia dos HerÃ³is Nacionais â€” homenagem a AmÃ­lcar Cabral" },
                    { date: `${year}-01-22`, name: "Dia de SÃ£o Vicente", desc: "Dia da ilha de SÃ£o Vicente â€” concertos na Rua de Lisboa" },
                    { date: fmt(addDays(shroveTuesday, -21)), name: "InÃ­cio dos Mandingas", desc: "Desfiles dominicais da tradiÃ§Ã£o dos Mandingas comeÃ§am em Mindelo" },
                    { date: fmt(shroveTuesday), name: "Carnaval â€” TerÃ§a de Entrudo", desc: "TerÃ§a-feira de Entrudo â€” o maior desfile de Carnaval de Cabo Verde em Mindelo" },
                    { date: fmt(ashWednesday), name: "Quarta-feira de Cinzas", desc: "Quarta-feira de Cinzas â€” feriado nacional, cerimÃ³nia de premiaÃ§Ã£o do Carnaval" },
                    { date: fmt(goodFriday), name: "Sexta-feira Santa", desc: "Sexta-feira Santa" },
                    { date: `${year}-05-01`, name: "Dia do Trabalhador", desc: "Dia do Trabalhador" },
                    { date: `${year}-06-01`, name: "Dia da CrianÃ§a", desc: "Dia da CrianÃ§a â€” festividades por todas as ilhas" },
                    { date: `${year}-06-24`, name: "SÃ£o JoÃ£o â€” Kola San Djon", desc: "Festival de SÃ£o JoÃ£o em Ribeira de JuliÃ£o â€” mÃºsica, tambores, saltos sobre fogueiras" },
                    { date: `${year}-07-05`, name: "Dia da IndependÃªncia", desc: "Dia da IndependÃªncia â€” dia nacional de Cabo Verde, grandes concertos" },
                    { date: `${year}-08-15`, name: "Nossa Senhora da GraÃ§a", desc: "AssunÃ§Ã£o de Maria â€” festividades da santa padroeira" },
                    { date: `${year}-08-15`, name: "BaÃ­a das Gatas Festival", desc: "Festival de mÃºsica gratuito ao ar livre perto de Mindelo (fim de semana de lua cheia em agosto)" },
                    { date: `${year}-09-12`, name: "Dia da NaÃ§Ã£o", desc: "Dia da Nacionalidade â€” celebraÃ§Ã£o da identidade e cultura cabo-verdianas" },
                    { date: `${year}-10-01`, name: "Mindelact", desc: "Festival internacional de teatro em Mindelo (setembro/outubro)" },
                    { date: `${year}-11-01`, name: "Dia de Todos os Santos", desc: "Dia de Todos os Santos" },
                    { date: `${year}-12-25`, name: "Natal", desc: "Dia de Natal â€” reuniÃµes familiares e comida festiva" },
                    { date: `${year}-12-31`, name: "RÃ©veillon", desc: "Noite de Ano Novo â€” grande concerto na Rua de Lisboa" }
                ]
            };

            const chEvents = {
                en: [
                    { date: `${year}-01-01`, name: "Nouvel An", desc: "New Year's Day" },
                    { date: `${year}-01-02`, name: "Saint-Berchtold", desc: "Vaud cantonal holiday, unique to Lausanne's region" },
                    { date: fmt(goodFriday), name: "Vendredi Saint", desc: "Good Friday" },
                    { date: fmt(easterMonday), name: "Lundi de PÃ¢ques", desc: "Easter Monday â€” chocolate eggs and family brunches" },
                    { date: fmt(ascension), name: "Ascension", desc: "Ascension Day â€” a Thursday off, long weekend tradition" },
                    { date: fmt(whitMonday), name: "Lundi de PentecÃ´te", desc: "Whit Monday" },
                    { date: `${year}-08-01`, name: "FÃªte nationale", desc: "Swiss National Day â€” fireworks, bonfires, and fondue" },
                    { date: fmt(federalFast), name: "Lundi du JeÃ»ne fÃ©dÃ©ral", desc: "Federal Fast Monday â€” Vaud tradition" },
                    { date: `${year}-12-25`, name: "NoÃ«l", desc: "Christmas Day â€” fondue, raclette, and vin chaud" },
                    { date: `${year}-02-01`, name: "Prix de Lausanne", desc: "Prestigious international ballet competition for young dancers (early February)" },
                    { date: `${year}-04-27`, name: "BDFIL", desc: "Lausanne International Comics Festival â€” two weeks in the train station quarter" },
                    { date: `${year}-05-01`, name: "BalÃ©lec", desc: "EPFL's massive open-air student festival â€” one of the largest in Europe" },
                    { date: `${year}-05-23`, name: "Caves Ouvertes Vaudoises", desc: "200+ Vaud winemakers open their doors â€” Chasselas tastings across Lavaux" },
                    { date: `${year}-06-21`, name: "FÃªte de la Musique", desc: "Free city-wide music festival â€” stages pop up across Lausanne" },
                    { date: `${year}-06-30`, name: "Festival de la CitÃ©", desc: "Free multi-arts festival â€” theatre, dance, music in Lausanne's old town (early July)" },
                    { date: `${year}-07-04`, name: "Montreux Jazz Festival", desc: "Legendary two-week jazz & music festival on Lake Geneva (mid-July)" },
                    { date: `${year}-07-21`, name: "PalÃ©o Festival Nyon", desc: "Switzerland's biggest open-air festival â€” 230,000 spectators over 6 days" },
                    { date: `${year}-08-21`, name: "Athletissima", desc: "Diamond League athletics meeting at the Olympic Stadium" },
                    { date: `${year}-09-26`, name: "Vendanges in Lavaux", desc: "Wine harvest season â€” vineyard experiences in the UNESCO Lavaux terraces" },
                    { date: `${year}-10-14`, name: "LUFF", desc: "Lausanne Underground Film & Music Festival â€” avant-garde cinema and sound" },
                    { date: `${year}-10-25`, name: "Lausanne Marathon", desc: "Scenic marathon along Lake Geneva â€” from Place de Milan to Ouchy" },
                    { date: `${year}-11-20`, name: "BÃ´ NoÃ«l", desc: "Lausanne's Christmas markets, light installations, and festive events until Dec 31" },
                    { date: `${year}-12-05`, name: "Les Urbaines", desc: "Free festival of artistic experimentation â€” sound, visual, and performing arts" }
                ],
                fr: [
                    { date: `${year}-01-01`, name: "Nouvel An", desc: "Jour de l'An" },
                    { date: `${year}-01-02`, name: "Saint-Berchtold", desc: "Jour fÃ©riÃ© cantonal vaudois, unique Ã  la rÃ©gion de Lausanne" },
                    { date: fmt(goodFriday), name: "Vendredi Saint", desc: "Vendredi Saint" },
                    { date: fmt(easterMonday), name: "Lundi de PÃ¢ques", desc: "Lundi de PÃ¢ques â€” Å“ufs en chocolat et brunchs en famille" },
                    { date: fmt(ascension), name: "Ascension", desc: "Jour de l'Ascension â€” un jeudi de congÃ©, tradition du long week-end" },
                    { date: fmt(whitMonday), name: "Lundi de PentecÃ´te", desc: "Lundi de PentecÃ´te" },
                    { date: `${year}-08-01`, name: "FÃªte nationale", desc: "FÃªte nationale suisse â€” feux d'artifice, feux de joie et fondue" },
                    { date: fmt(federalFast), name: "Lundi du JeÃ»ne fÃ©dÃ©ral", desc: "Lundi du JeÃ»ne fÃ©dÃ©ral â€” tradition vaudoise" },
                    { date: `${year}-12-25`, name: "NoÃ«l", desc: "NoÃ«l â€” fondue, raclette et vin chaud" },
                    { date: `${year}-02-01`, name: "Prix de Lausanne", desc: "Prestigieux concours international de ballet pour jeunes danseurs (dÃ©but fÃ©vrier)" },
                    { date: `${year}-04-27`, name: "BDFIL", desc: "Festival international de la bande dessinÃ©e de Lausanne â€” deux semaines au quartier de la gare" },
                    { date: `${year}-05-01`, name: "BalÃ©lec", desc: "Le grand festival en plein air de l'EPFL â€” l'un des plus grands d'Europe" },
                    { date: `${year}-05-23`, name: "Caves Ouvertes Vaudoises", desc: "Plus de 200 vignerons vaudois ouvrent leurs portes â€” dÃ©gustations de Chasselas Ã  travers Lavaux" },
                    { date: `${year}-06-21`, name: "FÃªte de la Musique", desc: "Festival de musique gratuit dans toute la ville â€” scÃ¨nes partout dans Lausanne" },
                    { date: `${year}-06-30`, name: "Festival de la CitÃ©", desc: "Festival multi-arts gratuit â€” thÃ©Ã¢tre, danse, musique dans la vieille ville (dÃ©but juillet)" },
                    { date: `${year}-07-04`, name: "Montreux Jazz Festival", desc: "LÃ©gendaire festival de jazz et musique de deux semaines au bord du lac LÃ©man (mi-juillet)" },
                    { date: `${year}-07-21`, name: "PalÃ©o Festival Nyon", desc: "Le plus grand festival en plein air de Suisse â€” 230 000 spectateurs sur 6 jours" },
                    { date: `${year}-08-21`, name: "Athletissima", desc: "Meeting d'athlÃ©tisme Diamond League au stade Olympique" },
                    { date: `${year}-09-26`, name: "Vendanges Ã  Lavaux", desc: "Saison des vendanges â€” expÃ©riences viticoles dans les terrasses UNESCO de Lavaux" },
                    { date: `${year}-10-14`, name: "LUFF", desc: "Lausanne Underground Film & Music Festival â€” cinÃ©ma et son avant-gardistes" },
                    { date: `${year}-10-25`, name: "Marathon de Lausanne", desc: "Marathon panoramique le long du lac LÃ©man â€” de la Place de Milan Ã  Ouchy" },
                    { date: `${year}-11-20`, name: "BÃ´ NoÃ«l", desc: "MarchÃ©s de NoÃ«l de Lausanne, illuminations et Ã©vÃ©nements festifs jusqu'au 31 dÃ©cembre" },
                    { date: `${year}-12-05`, name: "Les Urbaines", desc: "Festival gratuit d'expÃ©rimentation artistique â€” son, arts visuels et spectacle vivant" }
                ],
                pt: [
                    { date: `${year}-01-01`, name: "Nouvel An", desc: "Dia de Ano Novo" },
                    { date: `${year}-01-02`, name: "Saint-Berchtold", desc: "Feriado cantonal de Vaud, Ãºnico da regiÃ£o de Lausanne" },
                    { date: fmt(goodFriday), name: "Vendredi Saint", desc: "Sexta-feira Santa" },
                    { date: fmt(easterMonday), name: "Lundi de PÃ¢ques", desc: "Segunda-feira de PÃ¡scoa â€” ovos de chocolate e brunches em famÃ­lia" },
                    { date: fmt(ascension), name: "Ascension", desc: "Dia da AscensÃ£o â€” uma quinta-feira de folga, tradiÃ§Ã£o de fim de semana prolongado" },
                    { date: fmt(whitMonday), name: "Lundi de PentecÃ´te", desc: "Segunda-feira de Pentecostes" },
                    { date: `${year}-08-01`, name: "FÃªte nationale", desc: "Dia Nacional da SuÃ­Ã§a â€” fogo de artifÃ­cio, fogueiras e fondue" },
                    { date: fmt(federalFast), name: "Lundi du JeÃ»ne fÃ©dÃ©ral", desc: "Segunda-feira do Jejum Federal â€” tradiÃ§Ã£o de Vaud" },
                    { date: `${year}-12-25`, name: "NoÃ«l", desc: "Natal â€” fondue, raclette e vinho quente" },
                    { date: `${year}-02-01`, name: "Prix de Lausanne", desc: "Prestigiosa competiÃ§Ã£o internacional de ballet para jovens bailarinos (inÃ­cio de fevereiro)" },
                    { date: `${year}-04-27`, name: "BDFIL", desc: "Festival Internacional de Banda Desenhada de Lausanne â€” duas semanas no bairro da estaÃ§Ã£o" },
                    { date: `${year}-05-01`, name: "BalÃ©lec", desc: "O grande festival ao ar livre da EPFL â€” um dos maiores da Europa" },
                    { date: `${year}-05-23`, name: "Caves Ouvertes Vaudoises", desc: "Mais de 200 viticultores de Vaud abrem as suas portas â€” provas de Chasselas em Lavaux" },
                    { date: `${year}-06-21`, name: "FÃªte de la Musique", desc: "Festival de mÃºsica gratuito por toda a cidade â€” palcos espalhados por Lausanne" },
                    { date: `${year}-06-30`, name: "Festival de la CitÃ©", desc: "Festival multiartÃ­stico gratuito â€” teatro, danÃ§a, mÃºsica na cidade velha (inÃ­cio de julho)" },
                    { date: `${year}-07-04`, name: "Montreux Jazz Festival", desc: "LendÃ¡rio festival de jazz e mÃºsica de duas semanas no Lago LÃ©man (meados de julho)" },
                    { date: `${year}-07-21`, name: "PalÃ©o Festival Nyon", desc: "O maior festival ao ar livre da SuÃ­Ã§a â€” 230 000 espectadores em 6 dias" },
                    { date: `${year}-08-21`, name: "Athletissima", desc: "Meeting de atletismo Diamond League no EstÃ¡dio OlÃ­mpico" },
                    { date: `${year}-09-26`, name: "Vendanges in Lavaux", desc: "Ã‰poca das vindimas â€” experiÃªncias vinÃ­colas nos terraÃ§os UNESCO de Lavaux" },
                    { date: `${year}-10-14`, name: "LUFF", desc: "Lausanne Underground Film & Music Festival â€” cinema e som de vanguarda" },
                    { date: `${year}-10-25`, name: "Marathon de Lausanne", desc: "Maratona panorÃ¢mica ao longo do Lago LÃ©man â€” da Place de Milan a Ouchy" },
                    { date: `${year}-11-20`, name: "BÃ´ NoÃ«l", desc: "Mercados de Natal de Lausanne, instalaÃ§Ãµes de luz e eventos festivos atÃ© 31 de dezembro" },
                    { date: `${year}-12-05`, name: "Les Urbaines", desc: "Festival gratuito de experimentaÃ§Ã£o artÃ­stica â€” som, artes visuais e artes performativas" }
                ]
            };

            return { cvEvents: cvEvents[currentLang], chEvents: chEvents[currentLang] };
        }

        // ---- Language Switcher ----
        function setLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('timeBridgeLang', lang);
            document.documentElement.lang = lang;

            // Update active button
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.textContent === lang.toUpperCase());
            });

            // Update static text elements
            const staticKeys = [
                'subtitle', 'locationCv', 'locationCh',
                'happeningLabelCv', 'happeningLabelCh',
                'callTitle', 'callSubtitle', 'callHoursCvLabel', 'callHoursChLabel',
                'weatherTitle', 'weatherSubtitle', 'weatherCvTitle', 'weatherChTitle',
                'calendarTitle', 'calendarSubtitle',
                'mediaTitle', 'mediaSubtitle', 'mediaCvTitle', 'mediaChTitle',
                'neuroTitle', 'footerText'
            ];
            staticKeys.forEach(key => {
                const el = document.getElementById(key);
                if (el && T[key]) {
                    el.textContent = T[key][lang];
                }
            });

            // Update data-i18n elements (media type labels)
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (T[key]) el.textContent = T[key][lang];
            });

            // Update time diff text
            document.getElementById('timeDiffPrefix').textContent = T.timeDiffPrefix[lang];
            document.getElementById('timeDiffSuffix').textContent = T.timeDiffSuffix[lang];
            document.getElementById('workHoursCv').textContent = T.callHoursCvValue[lang];
            document.getElementById('workHoursCh').textContent = T.callHoursChValue[lang];

            // Re-render dynamic sections
            updateClocks();
            updateHappening(new Date());
            renderCalendar();
            renderNeuroTip();
            // Re-fetch weather to re-render with correct language
            fetchWeather();
        }

        // Make setLanguage global for onclick handlers
        window.setLanguage = setLanguage;

        // ---- Clock & Time ----
        function updateClocks() {
            const now = new Date();
            const locale = LOCALES[currentLang];

            // Mindelo time
            const cvOptions = { timeZone: MINDELO_TZ };
            const cvTime = now.toLocaleTimeString('en-GB', { ...cvOptions, hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
            const cvDate = now.toLocaleDateString(locale, { ...cvOptions, weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });
            const cvParts = cvTime.split(':');
            document.getElementById('timeMindelo').innerHTML =
                cvParts[0] + ':' + cvParts[1] + '<span class="clock-seconds">:' + cvParts[2] + '</span>';
            document.getElementById('dateMindelo').textContent = cvDate;

            // Lausanne time
            const chOptions = { timeZone: LAUSANNE_TZ };
            const chTime = now.toLocaleTimeString('en-GB', { ...chOptions, hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false });
            const chDate = now.toLocaleDateString(locale, { ...chOptions, weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' });
            const chParts = chTime.split(':');
            document.getElementById('timeLausanne').innerHTML =
                chParts[0] + ':' + chParts[1] + '<span class="clock-seconds">:' + chParts[2] + '</span>';
            document.getElementById('dateLausanne').textContent = chDate;

            // Calculate time difference
            const cvOffset = getTimezoneOffset(now, MINDELO_TZ);
            const chOffset = getTimezoneOffset(now, LAUSANNE_TZ);
            const diffHours = (chOffset - cvOffset) / 60;
            const hourWord = diffHours !== 1 ? T.hours[currentLang] : T.hour[currentLang];
            document.getElementById('timeDiff').textContent = diffHours + ' ' + hourWord;

            // Update timezone labels
            const isDST = isSwissDST(now);
            document.getElementById('tzLausanne').textContent = isDST ? 'CEST (UTC+2)' : 'CET (UTC+1)';
            document.getElementById('tzMindelo').textContent = 'CVT (UTCâˆ’1)';

            updateHappening(now);
            updateBestTimeToCall(now);
        }

        function getTimezoneOffset(date, tz) {
            const utcStr = date.toLocaleString('en-US', { timeZone: 'UTC' });
            const tzStr = date.toLocaleString('en-US', { timeZone: tz });
            const utcDate = new Date(utcStr);
            const tzDate = new Date(tzStr);
            return (tzDate - utcDate) / 60000;
        }

        function isSwissDST(date) {
            const jan = new Date(date.getFullYear(), 0, 1);
            const jul = new Date(date.getFullYear(), 6, 1);
            const janOffset = getTimezoneOffset(jan, LAUSANNE_TZ);
            const julOffset = getTimezoneOffset(jul, LAUSANNE_TZ);
            const currentOffset = getTimezoneOffset(date, LAUSANNE_TZ);
            return currentOffset === Math.max(janOffset, julOffset);
        }

        function getHourInTZ(date, tz) {
            return parseInt(date.toLocaleString('en-GB', { timeZone: tz, hour: '2-digit', hour12: false }));
        }

        // ---- Call overlap ----
        const CALL_AWAKE_WINDOW = { start: 8 * 60, end: 21 * 60 };

        function getMinutesInTZ(date, tz) {
            const parts = new Intl.DateTimeFormat('en-GB', {
                timeZone: tz,
                hour: '2-digit',
                minute: '2-digit',
                hour12: false
            }).formatToParts(date);
            const hour = parseInt(parts.find(p => p.type === 'hour').value, 10);
            const minute = parseInt(parts.find(p => p.type === 'minute').value, 10);
            return (hour * 60) + minute;
        }

        function isWithinAwakeWindow(minutes) {
            return minutes >= CALL_AWAKE_WINDOW.start && minutes < CALL_AWAKE_WINDOW.end;
        }

        function isWeekendInTZ(date, tz) {
            const weekday = new Intl.DateTimeFormat('en-US', {
                timeZone: tz,
                weekday: 'short'
            }).format(date);
            return weekday === 'Sat' || weekday === 'Sun';
        }

        function isOverlapMoment(date) {
            const mindeloMinutes = getMinutesInTZ(date, MINDELO_TZ);
            const lausanneMinutes = getMinutesInTZ(date, LAUSANNE_TZ);
            const weekendInMindelo = isWeekendInTZ(date, MINDELO_TZ);
            const weekendInLausanne = isWeekendInTZ(date, LAUSANNE_TZ);
            return weekendInMindelo &&
                   weekendInLausanne &&
                   isWithinAwakeWindow(mindeloMinutes) &&
                   isWithinAwakeWindow(lausanneMinutes);
        }

        function getOverlapWindows(now) {
            const stepMs = 15 * 60 * 1000;
            const start = new Date(Math.floor(now.getTime() / stepMs) * stepMs);
            const windows = [];
            let activeStart = null;

            for (let i = 0; i <= 672; i++) {
                const slot = new Date(start.getTime() + (i * stepMs));
                const active = isOverlapMoment(slot);

                if (active && !activeStart) {
                    activeStart = slot;
                }

                if ((!active || i === 672) && activeStart) {
                    windows.push({ start: activeStart, end: slot });
                    activeStart = null;
                }
            }

            return windows;
        }

        function formatTimeInTZ(date, tz) {
            return date.toLocaleTimeString(LOCALES[currentLang], {
                timeZone: tz,
                hour: '2-digit',
                minute: '2-digit',
                hour12: false
            });
        }

        function formatOverlapWindow(window) {
            const chStart = formatTimeInTZ(window.start, LAUSANNE_TZ);
            const chEnd = formatTimeInTZ(window.end, LAUSANNE_TZ);
            const cvStart = formatTimeInTZ(window.start, MINDELO_TZ);
            const cvEnd = formatTimeInTZ(window.end, MINDELO_TZ);
            return `${chStart}-${chEnd} ${T.callWindowPrefix[currentLang]} Â· ${cvStart}-${cvEnd} ${T.callWindowSuffix[currentLang]}`;
        }

        function updateBestTimeToCall(now) {
            const windows = getOverlapWindows(now);
            const currentWindow = windows.find(w => now >= w.start && now < w.end);
            const nextWindow = windows.find(w => w.start > now);
            const statusEl = document.getElementById('callStatus');
            const nextEl = document.getElementById('callNext');

            if (currentWindow) {
                statusEl.textContent = T.callStatusNow[currentLang];
                nextEl.textContent = `${T.callUntil[currentLang]} ${formatTimeInTZ(currentWindow.end, LAUSANNE_TZ)} ${T.callWindowPrefix[currentLang]} Â· ${formatTimeInTZ(currentWindow.end, MINDELO_TZ)} ${T.callWindowSuffix[currentLang]}`;
                return;
            }

            if (nextWindow) {
                statusEl.textContent = T.callStatusLater[currentLang];
                nextEl.textContent = formatOverlapWindow(nextWindow);
                return;
            }

            statusEl.textContent = T.callStatusNone[currentLang];
            nextEl.textContent = T.callNoWindow[currentLang];
        }

        // ---- What's Happening Now ----
        function updateHappening(now) {
            const cvHour = getHourInTZ(now, MINDELO_TZ);
            const chHour = getHourInTZ(now, LAUSANNE_TZ);

            const cvList = happeningCV[currentLang];
            const chList = happeningCH[currentLang];

            const cvScene = cvList.find(h => cvHour >= h.start && cvHour < h.end) || cvList[0];
            const chScene = chList.find(h => chHour >= h.start && chHour < h.end) || chList[0];

            document.getElementById('happeningCvEmoji').textContent = cvScene.emoji;
            document.getElementById('happeningCv').textContent = cvScene.text;
            document.getElementById('happeningChEmoji').textContent = chScene.emoji;
            document.getElementById('happeningCh').textContent = chScene.text;
        }

        // ---- Weather (Open-Meteo â€” free, no API key needed) ----
        const WMO_EMOJIS = {
            0: 'â˜€ï¸', 1: 'ğŸŒ¤ï¸', 2: 'â›…', 3: 'â˜ï¸',
            45: 'ğŸŒ«ï¸', 48: 'ğŸŒ«ï¸',
            51: 'ğŸŒ¦ï¸', 53: 'ğŸŒ¦ï¸', 55: 'ğŸŒ§ï¸',
            61: 'ğŸŒ§ï¸', 63: 'ğŸŒ§ï¸', 65: 'ğŸŒ§ï¸',
            71: 'ğŸŒ¨ï¸', 73: 'ğŸŒ¨ï¸', 75: 'â„ï¸', 77: 'â„ï¸',
            80: 'ğŸŒ¦ï¸', 81: 'ğŸŒ§ï¸', 82: 'ğŸŒ§ï¸',
            85: 'ğŸŒ¨ï¸', 86: 'â„ï¸',
            95: 'â›ˆï¸', 96: 'â›ˆï¸', 99: 'â›ˆï¸'
        };

        function getWmoDesc(code) {
            const key = 'wmo' + code;
            return T[key] ? T[key][currentLang] : 'Unknown';
        }

        function renderWeather(containerId, current) {
            const code = current.weather_code;
            const emoji = WMO_EMOJIS[code] || 'ğŸŒ¡ï¸';
            const desc = getWmoDesc(code);
            const temp = Math.round(current.temperature_2m);
            const feelsLike = Math.round(current.apparent_temperature);
            const humidity = current.relative_humidity_2m;
            const wind = Math.round(current.wind_speed_10m);

            document.getElementById(containerId).innerHTML = `
                <div class="weather-icon">${emoji}</div>
                <div class="weather-temp">${temp}Â°C</div>
                <div class="weather-desc">${desc}</div>
                <div class="weather-details">
                    <span>ğŸŒ¡ï¸ ${T.feelsLike[currentLang]} ${feelsLike}Â°</span>
                    <span>ğŸ’§ ${humidity}%</span>
                    <span>ğŸ’¨ ${wind} km/h</span>
                </div>
            `;
        }

        function renderWeatherError(containerId, msg) {
            document.getElementById(containerId).innerHTML =
                `<div class="weather-error">${msg}</div>`;
        }

        async function fetchWeather() {
            const cities = [
                { lat: 16.89, lon: -24.98, tz: 'Atlantic/Cape_Verde', container: 'weatherCvContent' },
                { lat: 46.52, lon: 6.63, tz: 'Europe/Zurich', container: 'weatherChContent' }
            ];

            for (const city of cities) {
                try {
                    const params = [
                        `latitude=${city.lat}`,
                        `longitude=${city.lon}`,
                        'current=temperature_2m,relative_humidity_2m,apparent_temperature,weather_code,wind_speed_10m',
                        `timezone=${encodeURIComponent(city.tz)}`
                    ].join('&');
                    const url = `https://api.open-meteo.com/v1/forecast?${params}`;
                    const res = await fetch(url);
                    if (!res.ok) {
                        renderWeatherError(city.container, T.weatherUnavailable[currentLang] + ' (HTTP ' + res.status + ')');
                        continue;
                    }
                    const data = await res.json();
                    renderWeather(city.container, data.current);
                } catch (err) {
                    renderWeatherError(city.container, T.weatherFetchError[currentLang]);
                }
            }
        }

        // ---- Cultural Calendar helpers ----
        function getEasterDate(year) {
            const a = year % 19;
            const b = Math.floor(year / 100);
            const c = year % 100;
            const d = Math.floor(b / 4);
            const e = b % 4;
            const f = Math.floor((b + 8) / 25);
            const g = Math.floor((b - f + 1) / 3);
            const h = (19 * a + b - d - g + 15) % 30;
            const i = Math.floor(c / 4);
            const k = c % 4;
            const l = (32 + 2 * e + 2 * i - h - k) % 7;
            const m = Math.floor((a + 11 * h + 22 * l) / 451);
            const month = Math.floor((h + l - 7 * m + 114) / 31);
            const day = ((h + l - 7 * m + 114) % 31) + 1;
            return new Date(year, month - 1, day);
        }

        function addDays(date, days) {
            const d = new Date(date);
            d.setDate(d.getDate() + days);
            return d;
        }

        function fmt(date) {
            const y = date.getFullYear();
            const m = String(date.getMonth() + 1).padStart(2, '0');
            const d = String(date.getDate()).padStart(2, '0');
            return `${y}-${m}-${d}`;
        }

        function getFederalFastMonday(year) {
            let d = new Date(year, 8, 1);
            const dayOfWeek = d.getDay();
            const firstSunday = dayOfWeek === 0 ? 1 : 8 - dayOfWeek;
            const thirdSunday = firstSunday + 14;
            return new Date(year, 8, thirdSunday + 1);
        }

        function renderCalendar() {
            const { cvEvents, chEvents } = getCulturalEvents();
            const now = new Date();
            now.setHours(0, 0, 0, 0);
            const locale = LOCALES[currentLang];

            function renderEvents(events, containerId, flag, title) {
                const sorted = events
                    .map(e => ({ ...e, dateObj: new Date(e.date + 'T00:00:00') }))
                    .sort((a, b) => a.dateObj - b.dateObj);

                const upcoming = sorted.filter(e => e.dateObj >= now);
                const past = sorted.filter(e => e.dateObj < now);
                const nextUp = upcoming[0];
                const rest = [...upcoming.slice(1), ...past];
                const listId = containerId + 'List';

                function eventHTML(e, isPast) {
                    const dateStr = e.dateObj.toLocaleDateString(locale, { day: 'numeric', month: 'short' });
                    return `
                        <div class="event-item ${isPast ? 'event-past' : ''}">
                            <div class="event-date">${dateStr}</div>
                            <div class="event-info">
                                <div class="event-name">${e.name}</div>
                                <div class="event-desc">${e.desc}</div>
                            </div>
                        </div>`;
                }

                const nextUpHTML = nextUp ? `
                    <div class="calendar-next">
                        <div class="event-date">${nextUp.dateObj.toLocaleDateString(locale, { day: 'numeric', month: 'short' })}</div>
                        <div class="event-info">
                            <div class="next-label">${T.nextUp[currentLang]}</div>
                            <div class="event-name">${nextUp.name}</div>
                            <div class="event-desc">${nextUp.desc}</div>
                        </div>
                    </div>` : '';

                const html = `
                    <div class="calendar-header">
                        <h3>${flag} ${title}</h3>
                        <span class="event-count">${sorted.length} ${T.events[currentLang]}</span>
                    </div>
                    ${nextUpHTML}
                    <div class="calendar-list-wrapper">
                        <div class="calendar-list" id="${listId}">
                            ${rest.map(e => eventHTML(e, e.dateObj < now)).join('')}
                        </div>
                        <div class="calendar-fade" id="${listId}Fade"></div>
                    </div>
                `;

                document.getElementById(containerId).innerHTML = html;

                const listEl = document.getElementById(listId);
                const fadeEl = document.getElementById(listId + 'Fade');
                if (listEl && fadeEl) {
                    function checkScroll() {
                        const atBottom = listEl.scrollHeight - listEl.scrollTop - listEl.clientHeight < 10;
                        fadeEl.classList.toggle('hidden', atBottom);
                        if (listEl.scrollHeight <= listEl.clientHeight) {
                            fadeEl.classList.add('hidden');
                        }
                    }
                    listEl.addEventListener('scroll', checkScroll);
                    checkScroll();
                }
            }

            renderEvents(cvEvents, 'calendarCv', 'ğŸ‡¨ğŸ‡»', T.calendarCvTitle[currentLang]);
            renderEvents(chEvents, 'calendarCh', 'ğŸ‡¨ğŸ‡­', T.calendarChTitle[currentLang]);
        }

        // ---- Neuroscience Tips ----
        function renderNeuroTip() {
            const now = new Date();
            const start = new Date(now.getFullYear(), 0, 0);
            const dayOfYear = Math.floor((now - start) / 86400000);
            const tips = neuroTips[currentLang];
            const tipIndex = dayOfYear % tips.length;
            const tip = tips[tipIndex];

            document.getElementById('neuroCategory').textContent = tip.category;
            document.getElementById('neuroEmoji').textContent = tip.emoji;
            document.getElementById('neuroTip').textContent = tip.tip;
            document.getElementById('neuroSource').textContent = tip.source;
        }

        // ---- Initialize ----
        function init() {
            // Apply saved language
            setLanguage(currentLang);

            // Start clock interval
            setInterval(updateClocks, 1000);
            // Refresh weather every 10 minutes
            setInterval(fetchWeather, 600000);
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    })();
    </script>
</body>
</html>
